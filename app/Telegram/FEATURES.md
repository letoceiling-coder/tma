# üéâ –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π Telegram –¥–ª—è Laravel

## ‚úÖ –ß—Ç–æ —É–∂–µ –±—ã–ª–æ

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã
- ‚úÖ **Bot.php** - 90+ –º–µ—Ç–æ–¥–æ–≤ Bot API
- ‚úÖ **Channel.php** - –†–∞–±–æ—Ç–∞ —Å –∫–∞–Ω–∞–ª–∞–º–∏ –∏ –≥—Ä—É–ø–ø–∞–º–∏ (25+ –º–µ—Ç–æ–¥–æ–≤)
- ‚úÖ **MiniApp.php** - –í–∞–ª–∏–¥–∞—Ü–∏—è Mini App
- ‚úÖ **Callback.php** - –û–±—Ä–∞–±–æ—Ç–∫–∞ callback query
- ‚úÖ **Keyboard.php** - –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞–≤–∏–∞—Ç—É—Ä
- ‚úÖ **Telegram.php** - –§–∞—Å–∞–¥ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

### –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ª–∏–º–∏—Ç—ã
- ‚úÖ **Limits.php** - –í—Å–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ª–∏–º–∏—Ç–æ–≤ API
- ‚úÖ **Validator.php** - 25+ –º–µ—Ç–æ–¥–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- ‚úÖ **RateLimiter.php** - –ö–æ–Ω—Ç—Ä–æ–ª—å —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **User.php** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Telegram
- ‚úÖ **Chat.php** - –ß–∞—Ç/–ö–∞–Ω–∞–ª
- ‚úÖ **Message.php** - –°–æ–æ–±—â–µ–Ω–∏–µ
- ‚úÖ **ChatMember.php** - –£—á–∞—Å—Ç–Ω–∏–∫ —á–∞—Ç–∞

### –ò—Å–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ **TelegramException** - –û–±—â–∏–µ –æ—à–∏–±–∫–∏
- ‚úÖ **TelegramValidationException** - –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ **README.md** - –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ **EXAMPLES.md** - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚úÖ **LIMITS.md** - –õ–∏–º–∏—Ç—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

---

## üöÄ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–ª—è Laravel

### 1. Service Provider
**TelegramServiceProvider**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤
- Singleton –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Artisan –∫–æ–º–∞–Ω–¥

### 2. Config —Ñ–∞–π–ª
**config/telegram.php**
- –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ .env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ webhook, rate limiting, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤

### 3. Middleware (3 —à—Ç—É–∫–∏)

**TelegramAuth**
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Mini App
- –í–∞–ª–∏–¥–∞—Ü–∏—è initData
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
- –î–æ–±–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ request

**TelegramWebhook**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ secret token
- –ü—Ä–æ–≤–µ—Ä–∫–∞ IP –∞–¥—Ä–µ—Å–∞ Telegram
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**TelegramAdmin**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### 4. Artisan –∫–æ–º–∞–Ω–¥—ã (4 —à—Ç—É–∫–∏)

**telegram:test**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ
- –°—Ç–∞—Ç—É—Å webhook

**telegram:set-webhook**
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ webhook
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ secret token
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ allowed_updates

**telegram:webhook-info**
- –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ webhook
- –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –û—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

**telegram:delete-webhook**
- –£–¥–∞–ª–µ–Ω–∏–µ webhook
- –û–ø—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ pending updates

### 5. Helper —Ñ—É–Ω–∫—Ü–∏–∏ (15+ —Ñ—É–Ω–∫—Ü–∏–π)

–ì–ª–æ–±–∞–ª—å–Ω—ã–µ helper —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞:
- `telegram()` - Bot
- `telegram_channel()` - Channel
- `telegram_miniapp()` - MiniApp  
- `telegram_send()` - –ë—ã—Å—Ç—Ä–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
- `telegram_inline_keyboard()` - –°–æ–∑–¥–∞—Ç—å inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
- `telegram_reply_keyboard()` - –°–æ–∑–¥–∞—Ç—å reply –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
- `telegram_check_subscription()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏
- `telegram_validate_miniapp()` - –í–∞–ª–∏–¥–∞—Ü–∏—è Mini App
- `telegram_get_user()` - –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `telegram_is_admin()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∞
- `telegram_format_html()` - –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML
- `telegram_format_markdown()` - –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Markdown
- `telegram_user_link()` - –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `telegram_deep_link()` - Deep link –¥–ª—è –±–æ—Ç–∞

### 6. Queue Jobs (3 —à—Ç—É–∫–∏)

**SendMessageJob**
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ –æ—à–∏–±–∫–µ
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**SendPhotoJob**
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ caption –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**SendBroadcastJob**
- –ú–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞
- –û—Ç–ø—Ä–∞–≤–∫–∞ –≤—Å–µ–º –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 7. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
**SETUP.md** - –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —á—Ç–æ –µ—â–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å

### Events & Listeners
```php
// –°–æ–±—ã—Ç–∏—è –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
Event::listen(NewTicketRestored::class, function($event) {
    telegram_send($event->user->telegram_id, '–ù–æ–≤—ã–π –±–∏–ª–µ—Ç!');
});
```

### Notifications —á–µ—Ä–µ–∑ Laravel
```php
// –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Laravel Notifications
class TicketNotification extends Notification
{
    public function via($notifiable)
    {
        return ['telegram'];
    }
    
    public function toTelegram($notifiable)
    {
        return TelegramMessage::create()
            ->to($notifiable->telegram_id)
            ->content('–ù–æ–≤—ã–π –±–∏–ª–µ—Ç!');
    }
}
```

### Webhook Router
```php
// –†–æ—É—Ç–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
TelegramRouter::on('message', MessageHandler::class);
TelegramRouter::on('callback_query', CallbackHandler::class);
TelegramRouter::on('inline_query', InlineHandler::class);
```

### Bot Commands
```php
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞
class StartCommand extends TelegramCommand
{
    protected $name = 'start';
    protected $description = '–ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞';
    
    public function handle($message)
    {
        telegram_send($message['chat']['id'], '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!');
    }
}
```

### Cache Manager
```php
// –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ API
$user = TelegramCache::remember('user:123456789', function() {
    return telegram()->getChat(123456789);
});
```

---

## üéØ –¢–µ–∫—É—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
1. **Bot API** - –í—Å–µ –º–µ—Ç–æ–¥—ã –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
2. **Mini App** - –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Ä–∞–±–æ—Ç–∞ —Å initData
3. **–ö–∞–Ω–∞–ª—ã** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö
5. **Rate Limiting** - –ö–æ–Ω—Ç—Ä–æ–ª—å —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤
6. **Laravel Integration** - Service Provider, Config, Middleware
7. **Artisan Commands** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ webhook
8. **Queue Jobs** - –û—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
9. **Helper Functions** - –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø
10. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏

### üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

**–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞:**
- üì¶ –í—Å–µ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- üîß –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- üí° –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π API
- üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚ö° Rate limiting –∏–∑ –∫–æ—Ä–æ–±–∫–∏

**–î–ª—è –ø—Ä–æ–µ–∫—Ç–∞:**
- üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫
- üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (middleware, validation)
- üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚è±Ô∏è –û—á–µ—Ä–µ–¥–∏ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- üéØ –°–æ–±–ª—é–¥–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ API
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

---

## üìù –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```php
// –ü—Ä–æ—Å—Ç–µ–π—à–∏–π —Å–ø–æ—Å–æ–±
telegram_send(123456789, '–ü—Ä–∏–≤–µ—Ç!');
```

### 2. –° –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
```php
use App\Telegram\Validator;

$text = "–û—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç...";
$text = Validator::truncateText($text, 4096);
telegram_send(123456789, $text);
```

### 3. –ß–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å
```php
use App\Jobs\Telegram\SendMessageJob;

SendMessageJob::dispatch(123456789, '–°–æ–æ–±—â–µ–Ω–∏–µ')
    ->delay(now()->addMinutes(5));
```

### 4. –° middleware
```php
Route::middleware('telegram.auth')->post('/api/tickets', function(Request $request) {
    $userId = $request->telegram_user_id;
    // ...
});
```

### 5. –° –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–æ–¥–ø–∏—Å–∫–∏
```php
if (!telegram_check_subscription('@channel', $userId)) {
    return response()->json(['error' => '–ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –∫–∞–Ω–∞–ª'], 403);
}
```

### 6. –ú–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞
```php
use App\Jobs\Telegram\SendBroadcastJob;

SendBroadcastJob::dispatch('–í–∞–∂–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö!');
```

### 7. Artisan –∫–æ–º–∞–Ω–¥—ã
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–æ—Ç–∞
php artisan telegram:test

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ webhook
php artisan telegram:set-webhook

# –†–∞—Å—Å—ã–ª–∫–∞ (—Å–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é –∫–æ–º–∞–Ω–¥—É)
php artisan telegram:broadcast "–ü—Ä–∏–≤–µ—Ç –≤—Å–µ–º!"
```

---

## üéâ –ò—Ç–æ–≥–æ

**–°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 30+

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** 4000+

**–ú–µ—Ç–æ–¥–æ–≤ API:** 90+

**Helper —Ñ—É–Ω–∫—Ü–∏–π:** 15+

**Middleware:** 3

**Artisan –∫–æ–º–∞–Ω–¥:** 4

**Queue Jobs:** 3

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** 5 —Ñ–∞–π–ª–æ–≤

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ production! üöÄ


