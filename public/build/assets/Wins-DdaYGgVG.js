import{_ as w,c as l,a as e,b as _,d as c,v as m,A as z,z as C,F,q as P,t as a,r as g,k as S,o as d,p as D}from"./admin-DvEgJ2ml.js";import{a as T}from"./api-DccBIR6h.js";const U={name:"Wins",setup(){const u=g(!1),o=g([]),p=g({current_page:1,last_page:1,per_page:50,total:0}),t=g({date_from:"",date_to:"",user_search:"",prize_type:"all"}),i=async(s=1)=>{u.value=!0;try{const n=new URLSearchParams({page:s.toString(),per_page:p.value.per_page.toString()});t.value.date_from&&n.append("date_from",t.value.date_from),t.value.date_to&&n.append("date_to",t.value.date_to),t.value.user_search&&n.append("user_search",t.value.user_search),t.value.prize_type!=="all"&&n.append("prize_type",t.value.prize_type);const x=await T(`/wow/wins?${n.toString()}`);if(x.ok){const f=await x.json();o.value=f.data||[],p.value=f.pagination||p.value}}catch(n){console.error("Error loading wins:",n)}finally{u.value=!1}},b=()=>{i(1)},r=()=>{t.value={date_from:"",date_to:"",user_search:"",prize_type:"all"},i(1)},y=s=>{i(s)},v=s=>s?new Date(s).toLocaleString("ru-RU"):"-",h=s=>({money:"Деньги",ticket:"Билет",secret_box:"Секретный бокс",empty:"Пусто"})[s]||s,k=s=>({money:"px-2 py-1 rounded bg-green-500/10 text-green-600 text-xs font-medium",ticket:"px-2 py-1 rounded bg-blue-500/10 text-blue-600 text-xs font-medium",secret_box:"px-2 py-1 rounded bg-purple-500/10 text-purple-600 text-xs font-medium",empty:"px-2 py-1 rounded bg-gray-500/10 text-gray-600 text-xs font-medium"})[s]||"";return S(()=>{i()}),{loading:u,wins:o,pagination:p,filters:t,fetchWins:i,applyFilters:b,resetFilters:r,loadPage:y,formatDate:v,getPrizeTypeLabel:h,getPrizeTypeClass:k}}},V={class:"wins-page space-y-6"},j={class:"bg-card rounded-lg border border-border p-6 space-y-4"},L={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},M={class:"flex gap-2"},B={class:"bg-card rounded-lg border border-border overflow-hidden"},N={class:"overflow-x-auto"},W={class:"w-full"},E={class:"divide-y divide-border"},I={class:"px-6 py-4 whitespace-nowrap text-sm"},R={class:"px-6 py-4 whitespace-nowrap text-sm"},q={class:"px-6 py-4 whitespace-nowrap text-sm"},A={class:"px-6 py-4 whitespace-nowrap text-sm"},G={class:"px-6 py-4 whitespace-nowrap text-sm"},H={key:0},J={key:1},K={key:2},O={class:"px-6 py-4 whitespace-nowrap text-sm"},Q={key:0,class:"px-6 py-4 border-t border-border flex items-center justify-between"},X={class:"text-sm text-muted-foreground"},Y={class:"flex gap-2"},Z=["disabled"],$=["disabled"],ee={key:0,class:"flex items-center justify-center py-12"};function te(u,o,p,t,i,b){return d(),l("div",V,[o[16]||(o[16]=e("div",null,[e("h1",{class:"text-3xl font-semibold text-foreground"},"Выигрыши"),e("p",{class:"text-muted-foreground mt-1"},"История всех выигрышей пользователей")],-1)),e("div",j,[o[13]||(o[13]=e("h2",{class:"text-lg font-semibold mb-4"},"Фильтры",-1)),e("div",L,[e("div",null,[o[8]||(o[8]=e("label",{class:"text-sm font-medium mb-1 block"},"Дата от",-1)),c(e("input",{"onUpdate:modelValue":o[0]||(o[0]=r=>t.filters.date_from=r),type:"date",class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[m,t.filters.date_from]])]),e("div",null,[o[9]||(o[9]=e("label",{class:"text-sm font-medium mb-1 block"},"Дата до",-1)),c(e("input",{"onUpdate:modelValue":o[1]||(o[1]=r=>t.filters.date_to=r),type:"date",class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[m,t.filters.date_to]])]),e("div",null,[o[10]||(o[10]=e("label",{class:"text-sm font-medium mb-1 block"},"Пользователь",-1)),c(e("input",{"onUpdate:modelValue":o[2]||(o[2]=r=>t.filters.user_search=r),type:"text",placeholder:"Telegram ID или username",class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[m,t.filters.user_search]])]),e("div",null,[o[12]||(o[12]=e("label",{class:"text-sm font-medium mb-1 block"},"Тип приза",-1)),c(e("select",{"onUpdate:modelValue":o[3]||(o[3]=r=>t.filters.prize_type=r),class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},[...o[11]||(o[11]=[C('<option value="all">Все</option><option value="money">Деньги</option><option value="ticket">Билет</option><option value="secret_box">Секретный бокс</option><option value="empty">Пусто</option>',5)])],512),[[z,t.filters.prize_type]])])]),e("div",M,[e("button",{onClick:o[4]||(o[4]=(...r)=>t.applyFilters&&t.applyFilters(...r)),class:"h-10 px-6 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-2xl shadow-lg shadow-accent/10 inline-flex items-center justify-center gap-2"}," Применить "),e("button",{onClick:o[5]||(o[5]=(...r)=>t.resetFilters&&t.resetFilters(...r)),class:"h-10 px-6 bg-muted text-muted-foreground border border-border hover:bg-muted/80 rounded-2xl inline-flex items-center justify-center gap-2"}," Сбросить ")])]),e("div",B,[e("div",N,[e("table",W,[o[14]||(o[14]=e("thead",{class:"bg-muted/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Дата"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Telegram ID"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Username"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Тип приза"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Сумма"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Сектор")])],-1)),e("tbody",E,[(d(!0),l(F,null,P(t.wins,r=>(d(),l("tr",{key:r.id,class:"hover:bg-muted/30"},[e("td",I,a(t.formatDate(r.spin_time)),1),e("td",R,a(r.user?.telegram_id||"-"),1),e("td",q,a(r.user?.username||"-"),1),e("td",A,[e("span",{class:D(t.getPrizeTypeClass(r.prize_type))},a(t.getPrizeTypeLabel(r.prize_type)),3)]),e("td",G,[r.prize_type==="money"?(d(),l("span",H,a(r.prize_value)+" ₽",1)):r.prize_type==="ticket"?(d(),l("span",J,a(r.prize_value)+" билет(ов)",1)):(d(),l("span",K,"-"))]),e("td",O," #"+a(r.sector_number||r.sector?.sector_number||"-"),1)]))),128))])])]),t.pagination.last_page>1?(d(),l("div",Q,[e("div",X," Показано "+a((t.pagination.current_page-1)*t.pagination.per_page+1)+" - "+a(Math.min(t.pagination.current_page*t.pagination.per_page,t.pagination.total))+" из "+a(t.pagination.total),1),e("div",Y,[e("button",{onClick:o[6]||(o[6]=r=>t.loadPage(t.pagination.current_page-1)),disabled:t.pagination.current_page===1,class:"h-10 px-4 border border-border rounded-lg hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed"}," Назад ",8,Z),e("button",{onClick:o[7]||(o[7]=r=>t.loadPage(t.pagination.current_page+1)),disabled:t.pagination.current_page===t.pagination.last_page,class:"h-10 px-4 border border-border rounded-lg hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed"}," Вперед ",8,$)])])):_("",!0)]),t.loading?(d(),l("div",ee,[...o[15]||(o[15]=[e("p",{class:"text-muted-foreground"},"Загрузка выигрышей...",-1)])])):_("",!0)])}const se=w(U,[["render",te]]);export{se as default};
