import{_ as m,c as i,a as t,b as g,t as n,F as _,q as f,r as b,k as x,o as d,E as v}from"./admin-BLV4-cJn.js";import{a as y}from"./api-DccBIR6h.js";const h={name:"Statistics",setup(){const c=b(!1),s=b({totalStars:0,totalSpins:0,activeUsers:0,totalUsers:0,prizeDistribution:[]}),u=async()=>{c.value=!0;try{const r=await y("/wow/users",{per_page:100});if(r.ok){const o=(await r.json()).data||[];s.value.totalUsers=o.length,s.value.activeUsers=o.filter(a=>a.spins_count>0).length,s.value.totalSpins=o.reduce((a,l)=>a+(l.spins_count||0),0),s.value.prizeDistribution=[{prize_type:"money",count:o.reduce((a,l)=>a+(l.total_wins||0),0)},{prize_type:"empty",count:s.value.totalSpins-o.reduce((a,l)=>a+(l.total_wins||0),0)}]}}catch(r){console.error("Error loading statistics:",r)}finally{c.value=!1}},e=r=>({money:"Денежные призы",ticket:"Билеты",secret_box:"Секретный бокс",empty:"Пусто"})[r]||r;return x(()=>{u()}),{loading:c,stats:s,getPrizeTypeLabel:e}}},S={class:"statistics-page space-y-6"},w={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},k={class:"bg-card rounded-lg border border-border p-6"},z={class:"text-2xl font-bold"},D={class:"bg-card rounded-lg border border-border p-6"},U={class:"text-2xl font-bold"},j={class:"bg-card rounded-lg border border-border p-6"},B={class:"text-2xl font-bold"},E={class:"bg-card rounded-lg border border-border p-6"},F={class:"text-2xl font-bold"},L={class:"bg-card rounded-lg border border-border p-6"},N={key:0,class:"space-y-4"},P={class:"text-sm font-medium"},T={class:"flex items-center gap-4"},V={class:"w-48 h-4 bg-muted rounded-full overflow-hidden"},W={class:"text-sm text-muted-foreground w-20 text-right"},q={key:1,class:"text-muted-foreground"},C={key:0,class:"flex items-center justify-center py-12"};function G(c,s,u,e,r,p){return d(),i("div",S,[s[6]||(s[6]=t("div",null,[t("h1",{class:"text-3xl font-semibold text-foreground"},"Статистика"),t("p",{class:"text-muted-foreground mt-1"},"Аналитика и метрики WOW Рулетка")],-1)),t("div",w,[t("div",k,[s[0]||(s[0]=t("p",{class:"text-sm text-muted-foreground mb-2"},"Всего звёзд получено",-1)),t("p",z,n(e.stats.totalStars),1)]),t("div",D,[s[1]||(s[1]=t("p",{class:"text-sm text-muted-foreground mb-2"},"Всего прокрутов",-1)),t("p",U,n(e.stats.totalSpins),1)]),t("div",j,[s[2]||(s[2]=t("p",{class:"text-sm text-muted-foreground mb-2"},"Активных пользователей",-1)),t("p",B,n(e.stats.activeUsers),1)]),t("div",E,[s[3]||(s[3]=t("p",{class:"text-sm text-muted-foreground mb-2"},"Всего пользователей",-1)),t("p",F,n(e.stats.totalUsers),1)])]),t("div",L,[s[4]||(s[4]=t("h2",{class:"text-xl font-semibold mb-4"},"Распределение призов",-1)),e.stats.prizeDistribution&&e.stats.prizeDistribution.length>0?(d(),i("div",N,[(d(!0),i(_,null,f(e.stats.prizeDistribution,o=>(d(),i("div",{key:o.prize_type,class:"flex items-center justify-between"},[t("span",P,n(e.getPrizeTypeLabel(o.prize_type)),1),t("div",T,[t("div",V,[t("div",{class:"h-full bg-accent transition-all",style:v({width:`${o.count/e.stats.totalSpins*100}%`})},null,4)]),t("span",W,n(o.count)+" ("+n((o.count/e.stats.totalSpins*100).toFixed(1))+"%) ",1)])]))),128))])):(d(),i("p",q,"Нет данных"))]),e.loading?(d(),i("div",C,[...s[5]||(s[5]=[t("p",{class:"text-muted-foreground"},"Загрузка статистики...",-1)])])):g("",!0)])}const R=m(h,[["render",G]]);export{R as default};
