import{_ as C,c as d,a as t,b as g,t as y,d as x,v as w,F as T,q as E,w as _,f as L,r as i,m as I,k as W,h as R,o as a}from"./admin-Co3w9kx-.js";import{a as D,c as N}from"./api-DccBIR6h.js";import{S as h}from"./sweetalert2.esm.all-C0u8rGqG.js";import z from"./Media-qr3mcRs2.js";const q={name:"Welcome",components:{Media:z},setup(){const v=i(!1),e=i(!1),c=i(null),o=i(""),b=i(""),s=i([]),f=i(!1),r=i(null),u=I(()=>s.value.length>0?s.value.every(l=>l.label&&l.label.trim()&&l.url&&l.url.trim()&&m(l.url)):!0),m=l=>{try{return new URL(l),!0}catch{return!1}},k=async()=>{v.value=!0,c.value=null;try{const l=await D("/wow/welcome");if(!l.ok)throw new Error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº");const n=await l.json();o.value=n.welcome_text||"",b.value=n.welcome_banner_url||"",s.value=(n.welcome_buttons||[]).map(p=>({...p}))}catch(l){c.value=l.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº"}finally{v.value=!1}},B=async()=>{if(!u.value){await h.fire({title:"ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸",text:"ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ ÐºÐ½Ð¾Ð¿Ð¾Ðº",icon:"error",confirmButtonText:"ÐžÐš"});return}e.value=!0,c.value=null;try{const l=await N("/wow/welcome",{welcome_text:o.value||null,welcome_banner_url:b.value||null,welcome_buttons:s.value.length>0?s.value:null});if(!l.ok){const n=await l.json();throw new Error(n.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº")}await h.fire({title:"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ñ‹",icon:"success",timer:1500,showConfirmButton:!1,toast:!0,position:"top-end"})}catch(l){c.value=l.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº",await h.fire({title:"ÐžÑˆÐ¸Ð±ÐºÐ°",text:l.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº",icon:"error",confirmButtonText:"ÐžÐš"})}finally{e.value=!1}},S=()=>{s.value.length<5&&s.value.push({label:"",url:""})},U=l=>{s.value.splice(l,1)},j=()=>{f.value=!0},M=()=>{f.value=!1,r.value=null},F=l=>{if(l&&l.length>0){const n=l[0],p=n.url||(n.metadata?.path?"/"+n.metadata.path:"");b.value=p||"",r.value=n,setTimeout(()=>{M()},300)}},V=l=>{l.target.style.display="none"};return W(()=>{k()}),{loading:v,saving:e,error:c,welcomeText:o,welcomeBannerUrl:b,welcomeButtons:s,showMediaModal:f,selectedMediaFile:r,isFormValid:u,fetchSettings:k,saveSettings:B,addButton:S,removeButton:U,openMediaSelector:j,closeMediaModal:M,handleMediaFileSelected:F,handleImageError:V}}},G={class:"welcome-page space-y-6"},H={key:0,class:"flex items-center justify-center py-12"},O={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},P={class:"text-destructive"},A={key:2,class:"space-y-6"},J={class:"bg-card rounded-lg border border-border p-6 space-y-4"},K={class:"bg-card rounded-lg border border-border p-6 space-y-4"},Q={class:"flex gap-2"},X={key:0,class:"mt-3"},Y=["src"],Z={class:"bg-card rounded-lg border border-border p-6 space-y-4"},$={class:"flex items-center justify-between mb-2"},ee=["disabled"],te={key:0,class:"text-sm text-muted-foreground py-4 text-center border border-dashed border-border rounded-lg"},oe={key:1,class:"space-y-3"},le={class:"flex items-center justify-between"},re={class:"text-sm font-medium"},se=["onClick"],ne=["onUpdate:modelValue"],de=["onUpdate:modelValue"],ae={class:"flex justify-end"},ie=["disabled"],ce={class:"flex items-center justify-between p-4 border-b border-border"},ue={class:"flex-1 overflow-hidden"};function me(v,e,c,o,b,s){const f=R("Media");return a(),d("div",G,[e[19]||(e[19]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h1",{class:"text-3xl font-semibold text-foreground"},"ÐŸÑ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ / Ð‘Ð°Ð½Ð½ÐµÑ€"),t("p",{class:"text-muted-foreground mt-1"},"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¿Ñ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ð³Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð´Ð»Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ /start")])],-1)),o.loading?(a(),d("div",H,[...e[9]||(e[9]=[t("div",{class:"text-muted-foreground"},"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°...",-1)])])):g("",!0),o.error?(a(),d("div",O,[t("p",P,y(o.error),1)])):g("",!0),o.loading?g("",!0):(a(),d("div",A,[t("div",J,[t("div",null,[e[10]||(e[10]=t("label",{class:"text-sm font-medium mb-2 block"},"Ð¢ÐµÐºÑÑ‚ Ð¿Ñ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ñ",-1)),x(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=r=>o.welcomeText=r),rows:"6",placeholder:`Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² WOW Spin!

ÐšÑ€ÑƒÑ‚Ð¸ Ñ€ÑƒÐ»ÐµÑ‚ÐºÑƒ, Ð·Ð¾Ð²Ð¸ Ð´Ñ€ÑƒÐ·ÐµÐ¹ Ð¸ Ð²Ñ‹Ð¸Ð³Ñ€Ñ‹Ð²Ð°Ð¹ Ð¿Ð¾Ð´Ð°Ñ€ÐºÐ¸ ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ ðŸŽ`,class:"w-full px-4 py-3 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent resize-none"},null,512),[[w,o.welcomeText]]),e[11]||(e[11]=t("p",{class:"text-xs text-muted-foreground mt-1"}," ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ÑÑ HTML Ñ€Ð°Ð·Ð¼ÐµÑ‚ÐºÐ°. ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 4096 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð². ",-1))])]),t("div",K,[t("div",null,[e[12]||(e[12]=t("label",{class:"text-sm font-medium mb-2 block"},"URL Ð±Ð°Ð½Ð½ÐµÑ€Ð° (ÐºÐ°Ñ€Ñ‚Ð¸Ð½ÐºÐ¸)",-1)),t("div",Q,[x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>o.welcomeBannerUrl=r),type:"text",placeholder:"https://...",class:"flex-1 h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[w,o.welcomeBannerUrl]]),t("button",{onClick:e[2]||(e[2]=(...r)=>o.openMediaSelector&&o.openMediaSelector(...r)),type:"button",class:"h-10 px-4 bg-accent/10 text-accent border border-accent/40 hover:bg-accent/20 rounded-lg inline-flex items-center justify-center gap-2 transition-colors",title:"Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð¸Ð· Ð¼ÐµÐ´Ð¸Ð°Ñ‚ÐµÐºÐ¸"}," ðŸ“ ")]),e[13]||(e[13]=t("p",{class:"text-xs text-muted-foreground mt-1"}," URL Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð±Ð°Ð½Ð½ÐµÑ€Ð°. Ð‘ÑƒÐ´ÐµÑ‚ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾ Ð¿ÐµÑ€ÐµÐ´ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ð¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÐµÐ¼. ",-1)),o.welcomeBannerUrl?(a(),d("div",X,[t("img",{src:o.welcomeBannerUrl,alt:"Ð‘Ð°Ð½Ð½ÐµÑ€",class:"max-w-md h-auto object-contain rounded border border-border",onError:e[3]||(e[3]=(...r)=>o.handleImageError&&o.handleImageError(...r))},null,40,Y)])):g("",!0)])]),t("div",Z,[t("div",null,[t("div",$,[e[14]||(e[14]=t("label",{class:"text-sm font-medium"},"Inline ÐºÐ½Ð¾Ð¿ÐºÐ¸",-1)),t("button",{onClick:e[4]||(e[4]=(...r)=>o.addButton&&o.addButton(...r)),type:"button",disabled:o.welcomeButtons.length>=5,class:"h-8 px-3 text-sm bg-accent/10 text-accent border border-accent/40 hover:bg-accent/20 rounded-lg inline-flex items-center justify-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," + Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÐ½Ð¾Ð¿ÐºÑƒ ",8,ee)]),e[17]||(e[17]=t("p",{class:"text-xs text-muted-foreground mb-4"}," ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 5 ÐºÐ½Ð¾Ð¿Ð¾Ðº. ÐšÐ½Ð¾Ð¿ÐºÐ¸ Ð±ÑƒÐ´ÑƒÑ‚ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°Ñ‚ÑŒÑÑ Ð¿Ð¾Ð´ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÐµÐ¼. ",-1)),o.welcomeButtons.length===0?(a(),d("div",te,' ÐÐµÑ‚ ÐºÐ½Ð¾Ð¿Ð¾Ðº. ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ "Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÐ½Ð¾Ð¿ÐºÑƒ" Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ. ')):(a(),d("div",oe,[(a(!0),d(T,null,E(o.welcomeButtons,(r,u)=>(a(),d("div",{key:u,class:"p-4 border border-border rounded-lg space-y-3"},[t("div",le,[t("span",re,"ÐšÐ½Ð¾Ð¿ÐºÐ° #"+y(u+1),1),t("button",{onClick:m=>o.removeButton(u),type:"button",class:"h-8 w-8 flex items-center justify-center rounded-lg hover:bg-destructive/10 text-destructive transition-colors",title:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ÐºÐ½Ð¾Ð¿ÐºÑƒ"}," âœ• ",8,se)]),t("div",null,[e[15]||(e[15]=t("label",{class:"text-xs font-medium mb-1 block"},"Ð¢ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸",-1)),x(t("input",{"onUpdate:modelValue":m=>r.label=m,type:"text",placeholder:"ÐÐ°Ñˆ ÐºÐ°Ð½Ð°Ð»",maxlength:"64",class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,8,ne),[[w,r.label]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"text-xs font-medium mb-1 block"},"URL",-1)),x(t("input",{"onUpdate:modelValue":m=>r.url=m,type:"url",placeholder:"https://t.me/WowSpin_news",maxlength:"500",class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,8,de),[[w,r.url]])])]))),128))]))])]),t("div",ae,[t("button",{onClick:e[5]||(e[5]=(...r)=>o.saveSettings&&o.saveSettings(...r)),disabled:o.saving||!o.isFormValid,class:"h-11 px-6 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-2xl shadow-lg shadow-accent/10 inline-flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[t("span",null,y(o.saving?"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ...":"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ"),1)],8,ie)])])),o.showMediaModal?(a(),d("div",{key:3,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:e[8]||(e[8]=_((...r)=>o.closeMediaModal&&o.closeMediaModal(...r),["self"]))},[t("div",{class:"bg-background border border-border rounded-lg shadow-2xl w-full max-w-6xl h-[90vh] flex flex-col",onClick:e[7]||(e[7]=_(()=>{},["stop"]))},[t("div",ce,[e[18]||(e[18]=t("h3",{class:"text-lg font-semibold"},"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð±Ð°Ð½Ð½ÐµÑ€",-1)),t("button",{onClick:e[6]||(e[6]=(...r)=>o.closeMediaModal&&o.closeMediaModal(...r)),class:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-muted transition-colors"}," âœ• ")]),t("div",ue,[L(f,{selectionMode:!0,countFile:1,selectedFiles:o.selectedMediaFile?[o.selectedMediaFile]:[],onFileSelected:o.handleMediaFileSelected},null,8,["selectedFiles","onFileSelected"])])])])):g("",!0)])}const xe=C(q,[["render",me],["__scopeId","data-v-fb3a942b"]]);export{xe as default};
