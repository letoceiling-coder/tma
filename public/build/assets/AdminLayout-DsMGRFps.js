import{_ as M,r as I,m as x,k as V,u as z,n as T,c as r,a as t,b as m,p as g,F as C,q as D,t as h,i as U,h as w,o as n,s as b,g as N,x as B,y as $,j as S,z as E,f as y,l as R}from"./admin-D73EZYWO.js";const A={template:'<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>'},O={template:'<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"></path></svg>'},F={template:'<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>'},P={template:'<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path></svg>'},q={template:'<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg>'},G={template:'<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>'},J={template:'<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>'},K={template:'<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>'},Q={template:'<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>'},W={name:"Sidebar",setup(){const i=z(),o=U(),l=I([]),e=I(localStorage.getItem("sidebarCollapsed")==="true"),p=x(()=>i.getters.menu),f=x(()=>i.getters.user),a=()=>{e.value=!e.value,localStorage.setItem("sidebarCollapsed",e.value.toString()),e.value&&(l.value=[])};V(()=>{i.getters.isAuthenticated&&i.dispatch("fetchMenu")}),T(()=>p.value,d=>{console.log("Menu updated in Sidebar:",d)},{immediate:!0});const s=x(()=>f.value?.name?f.value.name.split(" ").map(v=>v[0]).join("").toUpperCase().substring(0,2):"U");return{menu:p,user:f,userInitials:s,expandedItems:l,isCollapsed:e,toggleCollapse:a,toggleExpanded:d=>{const v=l.value.indexOf(d.title);v>-1?l.value.splice(v,1):l.value.push(d.title)},isExpanded:d=>l.value.includes(d.title),getIconComponent:d=>({home:A,database:O,"shopping-cart":F,folder:P,"credit-card":q,image:G,users:J,shield:K,settings:Q})[d]||A,handleLogout:async()=>{await i.dispatch("logout"),o.push("/login")}}}},X={class:"flex h-16 items-center border-b border-sidebar-border justify-between px-6"},Y={key:0,class:"text-xl font-bold text-sidebar-foreground"},Z=["title"],ee={class:"flex-1 overflow-y-auto space-y-1 nav-scroll p-4"},te={key:0,class:"text-center text-muted-foreground py-8"},oe={class:"h-5 w-5 shrink-0"},ne={key:0},se=["onClick","title"],re={class:"flex items-center gap-3"},ae={class:"h-5 w-5 shrink-0"},ie={key:0},le={class:"pl-4 pr-2 py-2 space-y-1"},de={class:"h-4 w-4 shrink-0"},ce={class:"border-t border-sidebar-border space-y-3 p-4"},ue={class:"h-10 w-10 rounded-full bg-accent/20 border border-accent/30 flex items-center justify-center text-sm font-bold text-accent shrink-0"},he={key:0,class:"flex-1 min-w-0"},fe={class:"text-sm font-semibold text-sidebar-foreground"},pe={class:"text-xs text-muted-foreground truncate"},ge=["title"],me={key:0};function ve(i,o,l,e,p,f){const a=w("router-link");return n(),r("aside",{class:g(["relative flex flex-col bg-sidebar-background text-sidebar-foreground transition-all duration-300 border-r border-sidebar-border hidden lg:flex",e.isCollapsed?"lg:w-16":"lg:w-72"])},[t("div",X,[e.isCollapsed?m("",!0):(n(),r("h1",Y,"CMS Admin")),t("button",{onClick:o[0]||(o[0]=(...s)=>e.toggleCollapse&&e.toggleCollapse(...s)),class:"rounded-xl p-2 hover:bg-sidebar-accent transition-all",title:e.isCollapsed?"Развернуть меню":"Свернуть меню"},[(n(),r("svg",{class:g(["h-5 w-5 transition-transform duration-300",e.isCollapsed?"rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...o[2]||(o[2]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"},null,-1)])],2))],8,Z)]),t("nav",ee,[!e.menu||e.menu.length===0?(n(),r("div",te," Загрузка меню... ")):(n(!0),r(C,{key:1},D(e.menu,s=>(n(),r(C,{key:s.route||s.title},[s.children?(n(),r("div",{key:1,class:g(["rounded-xl overflow-hidden transition-all",e.isExpanded(s)?"bg-sidebar-accent/30":""])},[t("button",{onClick:u=>e.toggleExpanded(s),class:g(["w-full flex items-center rounded-xl text-sm font-medium transition-all text-sidebar-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground px-4 py-3 gap-3",e.isCollapsed?"justify-center":"justify-between"]),title:e.isCollapsed?s.title:""},[t("div",re,[t("span",ae,[(n(),b(B(e.getIconComponent(s.icon))))]),e.isCollapsed?m("",!0):(n(),r("span",ie,h(s.title),1))]),e.isCollapsed?m("",!0):(n(),r("svg",{key:0,class:g(["h-4 w-4 shrink-0 transition-transform duration-200",e.isExpanded(s)?"rotate-180":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...o[3]||(o[3]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],10,se),e.isCollapsed?m("",!0):(n(),r("div",{key:0,class:g(["overflow-hidden transition-all duration-300 ease-in-out",e.isExpanded(s)?"max-h-96 opacity-100":"max-h-0 opacity-0"])},[t("div",le,[(n(!0),r(C,null,D(s.children,u=>(n(),b(a,{key:u.route,to:{name:u.route},class:"resource-submenu-item flex items-center gap-3 px-4 py-2 rounded-lg text-sm font-medium transition-all text-sidebar-foreground/80 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground"},{default:N(()=>[t("span",de,[(n(),b(B(e.getIconComponent(u.icon))))]),t("span",null,h(u.title),1)]),_:2},1032,["to"]))),128))])],2))],2)):(n(),b(a,{key:0,to:{name:s.route},class:g(["nav-menu-item flex items-center rounded-xl text-sm font-medium transition-all text-sidebar-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground px-4 py-3 gap-3",e.isCollapsed?"justify-center":""]),"active-class":"router-link-active",title:e.isCollapsed?s.title:""},{default:N(()=>[t("span",oe,[(n(),b(B(e.getIconComponent(s.icon))))]),e.isCollapsed?m("",!0):(n(),r("span",ne,h(s.title),1))]),_:2},1032,["to","class","title"]))],64))),128))]),t("div",ce,[t("div",{class:g(["flex items-center gap-3 px-2",e.isCollapsed?"justify-center":""])},[t("div",ue,h(e.userInitials),1),e.isCollapsed?m("",!0):(n(),r("div",he,[t("p",fe,h(e.user?.name||"Пользователь"),1),t("p",pe,h(e.user?.email||""),1)]))],2),t("button",{onClick:o[1]||(o[1]=(...s)=>e.handleLogout&&e.handleLogout(...s)),class:g(["w-full flex justify-start gap-2 px-4 py-2 text-muted-foreground hover:text-foreground rounded-md hover:bg-accent/10",e.isCollapsed?"justify-center":""]),title:e.isCollapsed?"Выйти":""},[o[4]||(o[4]=t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})],-1)),e.isCollapsed?m("",!0):(n(),r("span",me,"Выйти"))],10,ge)])],2)}const xe=M(W,[["render",ve]]),ke={name:"NotificationDropdown",setup(){const i=z(),o=I(!1),l=x(()=>(i.getters.notifications||[]).filter(k=>!k.read)),e=x(()=>i.getters.unreadNotificationsCount),p=()=>{o.value=!o.value,o.value&&i.dispatch("fetchNotifications")},f=async c=>{const k=l.value.find(d=>d.id===c);if(!(k&&k.read))try{(await S.post(`/api/notifications/${c}/read`)).data&&(await i.dispatch("fetchNotifications"),await a())}catch(d){console.error("Error marking notification as read:",d)}},a=async()=>{try{const c=await S.get("/api/notifications/unread-count");c.data&&c.data.count!==void 0&&await i.dispatch("fetchNotifications")}catch(c){console.error("Error fetching unread count:",c)}},s=c=>{if(!c)return"";const k=new Date(c),v=new Date-k,j=Math.floor(v/6e4),L=Math.floor(v/36e5),H=Math.floor(v/864e5);return j<1?"Только что":j<60?`${j} мин. назад`:L<24?`${L} ч. назад`:H<7?`${H} дн. назад`:k.toLocaleDateString("ru-RU")},u=c=>{c.target.closest(".relative")||(o.value=!1)};let _=null;return V(()=>{document.addEventListener("click",u),i.dispatch("fetchNotifications"),_=setInterval(()=>{a()},3e4)}),$(()=>{document.removeEventListener("click",u),_&&clearInterval(_)}),{isOpen:o,notifications:l,unreadCount:e,toggleDropdown:p,markAsRead:f,formatDate:s}}},be={class:"relative"},we={key:0,class:"absolute -top-1 -right-1 h-5 w-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-bold"},_e={key:0,class:"absolute right-0 top-full mt-2 w-80 bg-card border border-border rounded-lg shadow-lg z-40 max-h-96 overflow-hidden flex flex-col"},Ce={class:"overflow-y-auto flex-1"},ye={key:0,class:"p-4 text-center text-muted-foreground"},Me={key:1,class:"divide-y divide-border"},je=["onClick"],Be={class:"flex items-start gap-3"},Ie={class:"flex-1 min-w-0"},De={class:"flex items-center gap-2 mb-1"},ze={class:"font-semibold text-sm text-foreground"},Le={key:0,class:"h-2 w-2 bg-accent rounded-full flex-shrink-0"},He={class:"text-sm text-muted-foreground mb-2"},Ne={class:"text-xs text-muted-foreground"};function Se(i,o,l,e,p,f){return n(),r("div",be,[t("button",{onClick:o[0]||(o[0]=(...a)=>e.toggleDropdown&&e.toggleDropdown(...a)),class:"relative h-11 w-11 flex items-center justify-center rounded-md hover:bg-accent/10 transition-colors"},[o[1]||(o[1]=t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)),e.unreadCount>0?(n(),r("span",we,h(e.unreadCount>9?"9+":e.unreadCount),1)):m("",!0)]),e.isOpen?(n(),r("div",_e,[o[2]||(o[2]=t("div",{class:"flex items-center justify-between p-4 border-b border-border"},[t("h3",{class:"font-semibold text-foreground"},"Уведомления")],-1)),t("div",Ce,[e.notifications.length===0?(n(),r("div",ye," Нет уведомлений ")):(n(),r("div",Me,[(n(!0),r(C,null,D(e.notifications,a=>(n(),r("div",{key:a.id,onClick:s=>e.markAsRead(a.id),class:g(["p-4 hover:bg-accent/10 cursor-pointer transition-colors",a.read?"":"bg-accent/5 border-l-2 border-accent"])},[t("div",Be,[t("div",Ie,[t("div",De,[t("h4",ze,h(a.title),1),a.read?m("",!0):(n(),r("span",Le))]),t("p",He,h(a.message),1),t("span",Ne,h(a.created_at_human||e.formatDate(a.created_at)),1)])])],10,je))),128))]))])])):m("",!0)])}const Ee=M(ke,[["render",Se]]),Ae={name:"Header",components:{NotificationDropdown:Ee},setup(){const i=z(),o=R(),l=x(()=>i.getters.user),e=x(()=>i.getters.isDarkMode),p=x(()=>l.value?.name?l.value.name.split(" ").map(u=>u[0]).join("").toUpperCase().substring(0,2):"U"),f=x(()=>o.meta?.title||"Панель управления");return{user:l,userInitials:p,currentPageTitle:f,isDarkMode:e,toggleTheme:()=>{i.dispatch("toggleTheme")}}}},Ve={class:"relative flex h-16 items-center justify-between border-b border-border bg-card backdrop-blur-xl px-4 sm:px-6 gap-2 sm:gap-4 z-30"},Te={class:"flex items-center gap-2 sm:gap-3 min-w-0"},Ue={class:"hidden sm:flex items-center gap-2 text-sm min-w-0"},$e={class:"font-semibold text-foreground truncate"},Re={class:"flex sm:hidden items-center text-sm min-w-0"},Oe={class:"font-semibold text-foreground truncate"},Fe={class:"flex items-center gap-2 sm:gap-3"},Pe=["title"],qe={key:0,class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ge={key:1,class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Je={class:"h-9 w-9 sm:h-10 sm:w-10 rounded-full bg-accent/20 border border-accent/30 flex items-center justify-center text-sm font-bold text-accent flex-shrink-0"};function Ke(i,o,l,e,p,f){const a=w("NotificationDropdown");return n(),r("header",Ve,[t("div",Te,[o[3]||(o[3]=t("button",{class:"lg:hidden flex-shrink-0 h-11 w-11 flex items-center justify-center rounded-md hover:bg-accent/10 transition-colors"},[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})])],-1)),t("div",Ue,[o[1]||(o[1]=t("span",{class:"text-muted-foreground truncate"},"Панель управления",-1)),o[2]||(o[2]=t("span",{class:"text-muted-foreground"},"/",-1)),t("span",$e,h(e.currentPageTitle),1)]),t("div",Re,[t("span",Oe,h(e.currentPageTitle),1)])]),t("div",Fe,[o[6]||(o[6]=E('<div class="relative hidden md:block"><svg class="absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg><input type="search" placeholder="Поиск..." class="w-48 lg:w-64 pl-9 bg-input border-border rounded-xl h-11 text-sm focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent"></div><button class="md:hidden h-11 w-11 flex items-center justify-center rounded-md hover:bg-accent/10 transition-colors"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>',2)),y(a),t("button",{onClick:o[0]||(o[0]=(...s)=>e.toggleTheme&&e.toggleTheme(...s)),class:"h-11 w-11 flex items-center justify-center rounded-md hover:bg-accent/10 transition-colors",title:e.isDarkMode?"Переключить на светлую тему":"Переключить на темную тему"},[e.isDarkMode?(n(),r("svg",qe,[...o[4]||(o[4]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)])])):(n(),r("svg",Ge,[...o[5]||(o[5]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)])]))],8,Pe),o[7]||(o[7]=E('<div class="hidden lg:flex items-center gap-2"><button class="flex items-center gap-2 h-11 px-6 bg-accent text-accent-foreground rounded-xl hover:bg-accent/90 transition-colors"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Сохранить </button><button class="flex items-center gap-2 h-11 px-6 bg-accent text-accent-foreground rounded-xl hover:bg-accent/90 transition-colors"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg> Опубликовать </button></div><div class="relative lg:hidden"><button class="h-11 w-11 flex items-center justify-center bg-accent text-accent-foreground rounded-xl hover:bg-accent/90 transition-colors"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></button></div>',2)),t("div",Je,h(e.userInitials),1)])])}const Qe=M(Ae,[["render",Ke]]),We={name:"AdminLayout",components:{Sidebar:xe,Header:Qe}},Xe={class:"flex h-screen w-full overflow-hidden bg-background"},Ye={class:"flex flex-1 flex-col overflow-hidden min-w-0"},Ze={class:"flex-1 overflow-y-auto bg-background p-4 sm:p-6 lg:p-8"},et={class:"max-w-[1600px] mx-auto"};function tt(i,o,l,e,p,f){const a=w("Sidebar"),s=w("Header"),u=w("router-view");return n(),r("div",Xe,[y(a),t("div",Ye,[y(s),t("main",Ze,[t("div",et,[y(u)])])])])}const nt=M(We,[["render",tt]]);export{nt as default};
