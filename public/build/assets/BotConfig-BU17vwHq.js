import{r as c,k as B,c as d,a as t,b,t as v,w as C,d as p,v as m,B as f,j as g,o as i}from"./admin-DLTODJGx.js";const U={class:"bot-config-page space-y-6"},V={key:0,class:"flex items-center justify-center py-12"},A={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},T={class:"text-destructive"},W={key:2,class:"p-4 bg-green-500/10 border border-green-500/20 rounded-lg"},j={class:"text-green-600"},I={class:"bg-card rounded-lg border border-border p-6"},L={class:"space-y-4"},N={class:"bg-card rounded-lg border border-border p-6"},$={class:"space-y-4"},D={class:"flex gap-4"},H=["disabled"],R=["disabled"],S=["disabled"],q={class:"bg-card rounded-lg border border-border p-6"},z={class:"space-y-4"},E={class:"flex items-center gap-2"},G={key:0},O={key:1,class:"space-y-3"},F={class:"flex items-center gap-2"},J={key:0,class:"space-y-3 pl-6"},Q={__name:"BotConfig",setup(K){const u=c(!1),r=c(!1),l=c(null),n=c(null),a=c({bot_token:"",webhook_url:"",mini_app_url:"",welcome_message:{enabled:!0,text:"<b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</b>",mini_app_button:{enabled:!0,text:"üöÄ –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",url:""}}}),x=async()=>{u.value=!0,l.value=null;try{const o=await g.get("/api/v1/settings/bot");o.data&&(a.value={bot_token:o.data.bot_token||"",mini_app_url:o.data.mini_app_url||"",welcome_message:o.data.welcome_message||a.value.welcome_message})}catch(o){l.value=o.response?.data?.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫"}finally{u.value=!1}},_=async()=>{u.value=!0,l.value=null,n.value=null;try{const o=await g.post("/api/v1/settings/bot",a.value);n.value="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã",o.data.webhook_error&&(l.value=o.data.webhook_error),a.value.bot_token&&setTimeout(()=>{y()},1e3)}catch(o){l.value=o.response?.data?.message||"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫"}finally{u.value=!1}},k=async()=>{u.value=!0,l.value=null;try{const o=await g.post("/api/v1/settings/bot/test-connection");o.data.success?n.value="–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ! –ë–æ—Ç: "+o.data.bot.username:l.value=o.data.error||"–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"}catch(o){l.value=o.response?.data?.error||"–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"}finally{u.value=!1}},y=async()=>{u.value=!0,l.value=null;try{const o=await g.get("/api/v1/settings/bot/webhook-info");if(o.data.ok){const e=o.data.result;n.value=`Webhook: ${e.url||"–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"}, –û–∂–∏–¥–∞—é—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: ${e.pending_update_count||0}`}else l.value=o.data.description||"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏"}catch(o){l.value=o.response?.data?.error||"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ webhook"}finally{u.value=!1}},w=async()=>{r.value=!0,l.value=null,n.value=null;try{const o=await g.post("/api/v1/settings/bot/menu-button");o.data.success?n.value=o.data.message||"Menu button —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ":l.value=o.data.error||"–û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ menu button"}catch(o){l.value=o.response?.data?.error||"–û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ menu button"}finally{r.value=!1}},h=async()=>{r.value=!0,l.value=null,n.value=null;try{const o=await g.delete("/api/v1/settings/bot/menu-button");o.data.success?n.value=o.data.message||"Menu button —É–¥–∞–ª–µ–Ω":l.value=o.data.error||"–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è menu button"}catch(o){l.value=o.response?.data?.error||"–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è menu button"}finally{r.value=!1}},M=async()=>{r.value=!0,l.value=null,n.value=null;try{const o=await g.get("/api/v1/settings/bot/menu-button");if(o.data.ok){const e=o.data.result;n.value=`Menu Button: ${e.type||"default"}`}else l.value=o.data.description||"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏"}catch(o){l.value=o.response?.data?.error||"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ menu button"}finally{r.value=!1}};return B(()=>{x()}),(o,e)=>(i(),d("div",U,[e[20]||(e[20]=t("div",null,[t("h1",{class:"text-3xl font-semibold text-foreground"},"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞"),t("p",{class:"text-muted-foreground mt-1"},"–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Telegram –±–æ—Ç–∞ –∏ webhook")],-1)),u.value?(i(),d("div",V,[...e[7]||(e[7]=[t("p",{class:"text-muted-foreground"},"–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫...",-1)])])):b("",!0),l.value?(i(),d("div",A,[t("p",T,v(l.value),1)])):b("",!0),n.value?(i(),d("div",W,[t("p",j,v(n.value),1)])):b("",!0),u.value?b("",!0):(i(),d("form",{key:3,onSubmit:C(_,["prevent"]),class:"space-y-6"},[t("div",I,[e[10]||(e[10]=t("h2",{class:"text-xl font-semibold mb-4"},"–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏",-1)),t("div",L,[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium mb-2"},"–¢–æ–∫–µ–Ω –±–æ—Ç–∞",-1)),p(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>a.value.bot_token=s),type:"text",class:"w-full px-4 py-2 border border-border rounded-lg bg-background",placeholder:"1234567890:ABCdefGHIjklMNOpqrsTUVwxyz"},null,512),[[m,a.value.bot_token]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium mb-2"},"Mini App URL",-1)),p(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.mini_app_url=s),type:"url",class:"w-full px-4 py-2 border border-border rounded-lg bg-background",placeholder:"https://example.com"},null,512),[[m,a.value.mini_app_url]])])])]),t("div",N,[e[12]||(e[12]=t("h2",{class:"text-xl font-semibold mb-4"},"Menu Button (–ú–µ–Ω—é WebApp)",-1)),t("div",$,[e[11]||(e[11]=t("p",{class:"text-sm text-muted-foreground"}," –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é –≤ WebApp (—Ç—Ä–∏ –ø–æ–ª–æ—Å–∫–∏ —Å–ª–µ–≤–∞). –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –∫–æ–º–∞–Ω–¥—É /start –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. ",-1)),t("div",D,[t("button",{type:"button",onClick:w,disabled:r.value,class:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},v(r.value?"–£—Å—Ç–∞–Ω–æ–≤–∫–∞...":"–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –°—Ç–∞—Ä—Ç"),9,H),t("button",{type:"button",onClick:h,disabled:r.value,class:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},v(r.value?"–£–¥–∞–ª–µ–Ω–∏–µ...":"–£–¥–∞–ª–∏—Ç—å –∫–Ω–æ–ø–∫—É"),9,R),t("button",{type:"button",onClick:M,disabled:r.value,class:"px-6 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ–Ω—é ",8,S)])])]),t("div",q,[e[18]||(e[18]=t("h2",{class:"text-xl font-semibold mb-4"},"–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ",-1)),t("div",z,[t("div",E,[p(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.welcome_message.enabled=s),type:"checkbox",id:"welcome_enabled",class:"w-4 h-4"},null,512),[[f,a.value.welcome_message.enabled]]),e[13]||(e[13]=t("label",{for:"welcome_enabled",class:"text-sm font-medium"},"–í–∫–ª—é—á–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ",-1))]),a.value.welcome_message.enabled?(i(),d("div",G,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium mb-2"},"–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (HTML)",-1)),p(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.welcome_message.text=s),rows:"5",class:"w-full px-4 py-2 border border-border rounded-lg bg-background",placeholder:"<b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</b>"},null,512),[[m,a.value.welcome_message.text]])])):b("",!0),a.value.welcome_message.enabled?(i(),d("div",O,[t("div",F,[p(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.welcome_message.mini_app_button.enabled=s),type:"checkbox",id:"button_enabled",class:"w-4 h-4"},null,512),[[f,a.value.welcome_message.mini_app_button.enabled]]),e[15]||(e[15]=t("label",{for:"button_enabled",class:"text-sm font-medium"},"–î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É Mini App",-1))]),a.value.welcome_message.mini_app_button.enabled?(i(),d("div",J,[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium mb-2"},"–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏",-1)),p(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>a.value.welcome_message.mini_app_button.text=s),type:"text",class:"w-full px-4 py-2 border border-border rounded-lg bg-background",placeholder:"üöÄ –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"},null,512),[[m,a.value.welcome_message.mini_app_button.text]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium mb-2"},"URL Mini App",-1)),p(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>a.value.welcome_message.mini_app_button.url=s),type:"url",class:"w-full px-4 py-2 border border-border rounded-lg bg-background",placeholder:"https://example.com"},null,512),[[m,a.value.welcome_message.mini_app_button.url]])])])):b("",!0)])):b("",!0)])]),t("div",{class:"flex gap-4"},[e[19]||(e[19]=t("button",{type:"submit",class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 transition-colors"}," –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ",-1)),t("button",{type:"button",onClick:k,class:"px-6 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 transition-colors"}," –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ "),t("button",{type:"button",onClick:y,class:"px-6 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 transition-colors"}," –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ webhook ")])],32))]))}};export{Q as default};
