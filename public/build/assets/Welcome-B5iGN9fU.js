import{_ as z,c as d,a as t,b as g,t as m,d as p,v as x,F as h,q as k,w as H,f as D,r as u,m as R,k as W,h as A,o as a,E as N,p as C}from"./admin-ClPi5g1x.js";import{a as P,c as O}from"./api-DccBIR6h.js";import{S as M}from"./sweetalert2.esm.all-C0u8rGqG.js";import X from"./Media-DDsmu8ZB.js";const Y={name:"Welcome",components:{Media:X},setup(){const s=u(!1),e=u(!1),f=u(null),l=u(""),y=u(""),b=u([]),w=u(!1),o=u(null);u(null);const n=u([]);u(null),u(!1),u({houseIndex:null,startX:0,startY:0,startLeft:0,startTop:0});const c=R(()=>b.value.length>0?b.value.every(r=>r.label&&r.label.trim()&&r.url&&r.url.trim()&&U(r.url)):!0),U=r=>{try{return new URL(r),!0}catch{return!1}},I=async()=>{s.value=!0,f.value=null;try{const r=await P("/wow/welcome");if(!r.ok)throw new Error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº");const i=await r.json();l.value=i.welcome_text||"",y.value=i.welcome_banner_url||"",b.value=(i.welcome_buttons||[]).map(v=>({...v})),i.houses&&Array.isArray(i.houses)?n.value=i.houses.map(v=>({...v,active:!1})):n.value=[]}catch(r){f.value=r.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº"}finally{s.value=!1}},S=async()=>{if(!c.value){await M.fire({title:"ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸",text:"ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ ÐºÐ½Ð¾Ð¿Ð¾Ðº",icon:"error",confirmButtonText:"ÐžÐš"});return}e.value=!0,f.value=null;try{const r=await O("/wow/welcome",{welcome_text:l.value||null,welcome_banner_url:y.value||null,welcome_buttons:b.value.length>0?b.value:null,houses:n.value.length>0?n.value.map(i=>({x:i.x,y:i.y})):null});if(!r.ok){const i=await r.json();let v=i.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº";if(i.errors){const B=Object.values(i.errors).flat();B.length>0&&(v=B.join(`
`))}throw new Error(v)}await M.fire({title:"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ñ‹",icon:"success",timer:1500,showConfirmButton:!1,toast:!0,position:"top-end"})}catch(r){f.value=r.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº",await M.fire({title:"ÐžÑˆÐ¸Ð±ÐºÐ°",text:r.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº",icon:"error",confirmButtonText:"ÐžÐš"})}finally{e.value=!1}},F=()=>{b.value.length<5&&b.value.push({label:"",url:""})},V=r=>{b.value.splice(r,1)},L=()=>{w.value=!0},j=()=>{w.value=!1,o.value=null},T=r=>{if(r){const i=r.url||(r.metadata?.path?"/"+r.metadata.path:"");y.value=i||"",o.value=r,setTimeout(()=>{j()},300)}},E=r=>{r.target.style.display="none"};return W(()=>{I()}),{loading:s,saving:e,error:f,welcomeText:l,welcomeBannerUrl:y,welcomeButtons:b,showMediaModal:w,selectedMediaFile:o,isFormValid:c,fetchSettings:I,saveSettings:S,addButton:F,removeButton:V,openMediaSelector:L,closeMediaModal:j,handleMediaFileSelected:T,handleImageError:E}}},q={class:"welcome-page space-y-6"},G={key:0,class:"flex items-center justify-center py-12"},_={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},J={class:"text-destructive"},K={key:2,class:"space-y-6"},Q={class:"bg-card rounded-lg border border-border p-6 space-y-4"},Z={class:"bg-card rounded-lg border border-border p-6 space-y-4"},$={class:"flex gap-2"},ee={key:0,class:"mt-4"},te={class:"relative w-full overflow-hidden rounded-lg border border-border bg-background",style:{"min-height":"400px"}},oe=["src"],se=["onMousedown","onClick"],le=["disabled"],re={key:1,class:"absolute bottom-4 left-4 right-4 p-3 bg-background/95 backdrop-blur-sm rounded-lg border border-border shadow-lg"},ne={class:"flex items-center justify-between mb-2"},de={class:"text-sm font-medium"},ae={class:"grid grid-cols-2 gap-2 text-xs"},ie={key:0,class:"mt-4 p-3 bg-muted/50 rounded-lg"},ue={class:"flex items-center justify-between mb-2"},ce={class:"text-sm font-medium"},be={class:"flex flex-wrap gap-2"},me=["onClick"],ge={class:"bg-card rounded-lg border border-border p-6 space-y-4"},fe={class:"flex items-center justify-between mb-2"},ve=["disabled"],pe={key:0,class:"text-sm text-muted-foreground py-4 text-center border border-dashed border-border rounded-lg"},xe={key:1,class:"space-y-3"},ye={class:"flex items-center justify-between"},we={class:"text-sm font-medium"},he=["onClick"],ke=["onUpdate:modelValue"],Me=["onUpdate:modelValue"],Ie={class:"flex justify-end"},je=["disabled"],Be={class:"flex items-center justify-between p-4 border-b border-border"},He={class:"flex-1 overflow-y-auto min-h-0"};function Ce(s,e,f,l,y,b){const w=A("Media");return a(),d("div",q,[e[29]||(e[29]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h1",{class:"text-3xl font-semibold text-foreground"},"ÐŸÑ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ / Ð‘Ð°Ð½Ð½ÐµÑ€"),t("p",{class:"text-muted-foreground mt-1"},"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¿Ñ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ð³Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð´Ð»Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ /start")])],-1)),l.loading?(a(),d("div",G,[...e[17]||(e[17]=[t("div",{class:"text-muted-foreground"},"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°...",-1)])])):g("",!0),l.error?(a(),d("div",_,[t("p",J,m(l.error),1)])):g("",!0),l.loading?g("",!0):(a(),d("div",K,[t("div",Q,[t("div",null,[e[18]||(e[18]=t("label",{class:"text-sm font-medium mb-2 block"},"Ð¢ÐµÐºÑÑ‚ Ð¿Ñ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ñ",-1)),p(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=o=>l.welcomeText=o),rows:"6",placeholder:`Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² WOW Spin!

ÐšÑ€ÑƒÑ‚Ð¸ Ñ€ÑƒÐ»ÐµÑ‚ÐºÑƒ, Ð·Ð¾Ð²Ð¸ Ð´Ñ€ÑƒÐ·ÐµÐ¹ Ð¸ Ð²Ñ‹Ð¸Ð³Ñ€Ñ‹Ð²Ð°Ð¹ Ð¿Ð¾Ð´Ð°Ñ€ÐºÐ¸ ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ ðŸŽ`,class:"w-full px-4 py-3 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent resize-none"},null,512),[[x,l.welcomeText]]),e[19]||(e[19]=t("p",{class:"text-xs text-muted-foreground mt-1"}," ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ÑÑ HTML Ñ€Ð°Ð·Ð¼ÐµÑ‚ÐºÐ°. ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 4096 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð². ",-1))])]),t("div",Z,[t("div",null,[e[22]||(e[22]=t("label",{class:"text-sm font-medium mb-2 block"},"URL Ð±Ð°Ð½Ð½ÐµÑ€Ð° (ÐºÐ°Ñ€Ñ‚Ð¸Ð½ÐºÐ¸ ÐºÐ°Ñ€Ñ‚Ñ‹)",-1)),t("div",$,[p(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.welcomeBannerUrl=o),type:"text",placeholder:"https://...",class:"flex-1 h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[x,l.welcomeBannerUrl]]),t("button",{onClick:e[2]||(e[2]=(...o)=>l.openMediaSelector&&l.openMediaSelector(...o)),type:"button",class:"h-10 px-4 bg-accent/10 text-accent border border-accent/40 hover:bg-accent/20 rounded-lg inline-flex items-center justify-center gap-2 transition-colors",title:"Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð¸Ð· Ð¼ÐµÐ´Ð¸Ð°Ñ‚ÐµÐºÐ¸"}," ðŸ“ ")]),e[23]||(e[23]=t("p",{class:"text-xs text-muted-foreground mt-1"}," URL Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð±Ð°Ð½Ð½ÐµÑ€Ð°/ÐºÐ°Ñ€Ñ‚Ñ‹. Ð‘ÑƒÐ´ÐµÑ‚ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾ Ð¿ÐµÑ€ÐµÐ´ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ð¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÐµÐ¼. ",-1)),l.welcomeBannerUrl?(a(),d("div",ee,[t("div",te,[t("img",{src:l.welcomeBannerUrl,alt:"ÐšÐ°Ñ€Ñ‚Ð°",ref:"mapImageRef",class:"w-full h-auto object-contain",style:{display:"block","max-width":"100%",height:"auto"},onLoad:e[3]||(e[3]=(...o)=>s.onMapImageLoad&&s.onMapImageLoad(...o)),onError:e[4]||(e[4]=(...o)=>l.handleImageError&&l.handleImageError(...o))},null,40,oe),(a(!0),d(h,null,k(s.houses,(o,n)=>(a(),d("div",{key:n,class:"absolute cursor-move transition-all hover:scale-110",style:N({left:o.x+"%",top:o.y+"%",transform:"translate(-50%, -50%)",zIndex:o.active?20:10}),onMousedown:c=>s.startDrag(n,c),onClick:c=>s.selectHouse(n)},[t("div",{class:C(["w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs font-bold",o.active?"bg-accent border-accent text-accent-foreground":"bg-white border-gray-400 text-gray-700"])},m(n+1),3)],44,se))),128)),s.isDragging?g("",!0):(a(),d("button",{key:0,onClick:e[5]||(e[5]=(...o)=>s.addHouse&&s.addHouse(...o)),type:"button",class:"absolute top-4 right-4 px-3 py-2 bg-accent/90 text-accent-foreground rounded-lg text-sm font-medium hover:bg-accent transition-colors shadow-lg",disabled:s.houses.length>=20}," + Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð´Ð¾Ð¼Ð¸Ðº ",8,le)),s.selectedHouseIndex!==null&&s.houses[s.selectedHouseIndex]?(a(),d("div",re,[t("div",ne,[t("span",de,"Ð”Ð¾Ð¼Ð¸Ðº #"+m(s.selectedHouseIndex+1),1),t("button",{onClick:e[6]||(e[6]=o=>s.removeHouse(s.selectedHouseIndex)),type:"button",class:"text-destructive hover:text-destructive/80 text-sm"}," Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ")]),t("div",ae,[t("div",null,[e[20]||(e[20]=t("label",{class:"text-muted-foreground"},"X:",-1)),p(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>s.houses[s.selectedHouseIndex].x=o),type:"number",min:"0",max:"100",step:"0.1",class:"w-full px-2 py-1 border border-border rounded bg-background text-xs",onInput:e[8]||(e[8]=o=>s.updateHousePosition(s.selectedHouseIndex))},null,544),[[x,s.houses[s.selectedHouseIndex].x,void 0,{number:!0}]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"text-muted-foreground"},"Y:",-1)),p(t("input",{"onUpdate:modelValue":e[9]||(e[9]=o=>s.houses[s.selectedHouseIndex].y=o),type:"number",min:"0",max:"100",step:"0.1",class:"w-full px-2 py-1 border border-border rounded bg-background text-xs",onInput:e[10]||(e[10]=o=>s.updateHousePosition(s.selectedHouseIndex))},null,544),[[x,s.houses[s.selectedHouseIndex].y,void 0,{number:!0}]])])])])):g("",!0)]),s.houses.length>0?(a(),d("div",ie,[t("div",ue,[t("span",ce,"Ð”Ð¾Ð¼Ð¸ÐºÐ¸ Ð½Ð° ÐºÐ°Ñ€Ñ‚Ðµ ("+m(s.houses.length)+")",1),t("button",{onClick:e[11]||(e[11]=(...o)=>s.clearAllHouses&&s.clearAllHouses(...o)),type:"button",class:"text-xs text-destructive hover:text-destructive/80"}," ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ Ð²ÑÐµ ")]),t("div",be,[(a(!0),d(h,null,k(s.houses,(o,n)=>(a(),d("button",{key:n,onClick:c=>s.selectHouse(n),type:"button",class:C(["px-2 py-1 rounded text-xs border transition-colors",o.active?"bg-accent text-accent-foreground border-accent":"bg-background border-border hover:bg-muted"])}," Ð”Ð¾Ð¼Ð¸Ðº "+m(n+1)+" ("+m(Math.round(o.x))+"%, "+m(Math.round(o.y))+"%) ",11,me))),128))])])):g("",!0)])):g("",!0)])]),t("div",ge,[t("div",null,[t("div",fe,[e[24]||(e[24]=t("label",{class:"text-sm font-medium"},"Inline ÐºÐ½Ð¾Ð¿ÐºÐ¸",-1)),t("button",{onClick:e[12]||(e[12]=(...o)=>l.addButton&&l.addButton(...o)),type:"button",disabled:l.welcomeButtons.length>=5,class:"h-8 px-3 text-sm bg-accent/10 text-accent border border-accent/40 hover:bg-accent/20 rounded-lg inline-flex items-center justify-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," + Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÐ½Ð¾Ð¿ÐºÑƒ ",8,ve)]),e[27]||(e[27]=t("p",{class:"text-xs text-muted-foreground mb-4"}," ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 5 ÐºÐ½Ð¾Ð¿Ð¾Ðº. ÐšÐ½Ð¾Ð¿ÐºÐ¸ Ð±ÑƒÐ´ÑƒÑ‚ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°Ñ‚ÑŒÑÑ Ð¿Ð¾Ð´ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÐµÐ¼. ",-1)),l.welcomeButtons.length===0?(a(),d("div",pe,' ÐÐµÑ‚ ÐºÐ½Ð¾Ð¿Ð¾Ðº. ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ "Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÐ½Ð¾Ð¿ÐºÑƒ" Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ. ')):(a(),d("div",xe,[(a(!0),d(h,null,k(l.welcomeButtons,(o,n)=>(a(),d("div",{key:n,class:"p-4 border border-border rounded-lg space-y-3"},[t("div",ye,[t("span",we,"ÐšÐ½Ð¾Ð¿ÐºÐ° #"+m(n+1),1),t("button",{onClick:c=>l.removeButton(n),type:"button",class:"h-8 w-8 flex items-center justify-center rounded-lg hover:bg-destructive/10 text-destructive transition-colors",title:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ÐºÐ½Ð¾Ð¿ÐºÑƒ"}," âœ• ",8,he)]),t("div",null,[e[25]||(e[25]=t("label",{class:"text-xs font-medium mb-1 block"},"Ð¢ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸",-1)),p(t("input",{"onUpdate:modelValue":c=>o.label=c,type:"text",placeholder:"ÐÐ°Ñˆ ÐºÐ°Ð½Ð°Ð»",maxlength:"64",class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,8,ke),[[x,o.label]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"text-xs font-medium mb-1 block"},"URL",-1)),p(t("input",{"onUpdate:modelValue":c=>o.url=c,type:"url",placeholder:"https://t.me/WowSpin_news",maxlength:"500",class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,8,Me),[[x,o.url]])])]))),128))]))])]),t("div",Ie,[t("button",{onClick:e[13]||(e[13]=(...o)=>l.saveSettings&&l.saveSettings(...o)),disabled:l.saving||!l.isFormValid,class:"h-11 px-6 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-2xl shadow-lg shadow-accent/10 inline-flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[t("span",null,m(l.saving?"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ...":"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ"),1)],8,je)])])),l.showMediaModal?(a(),d("div",{key:3,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:e[16]||(e[16]=H((...o)=>l.closeMediaModal&&l.closeMediaModal(...o),["self"]))},[t("div",{class:"bg-background border border-border rounded-lg shadow-2xl w-full max-w-6xl h-[90vh] flex flex-col",onClick:e[15]||(e[15]=H(()=>{},["stop"]))},[t("div",Be,[e[28]||(e[28]=t("h3",{class:"text-lg font-semibold"},"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð±Ð°Ð½Ð½ÐµÑ€",-1)),t("button",{onClick:e[14]||(e[14]=(...o)=>l.closeMediaModal&&l.closeMediaModal(...o)),class:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-muted transition-colors"}," âœ• ")]),t("div",He,[D(w,{selectionMode:!0,countFile:1,selectedFiles:l.selectedMediaFile?[l.selectedMediaFile]:[],onFileSelected:l.handleMediaFileSelected},null,8,["selectedFiles","onFileSelected"])])])])):g("",!0)])}const Le=z(Y,[["render",Ce],["__scopeId","data-v-5e6afbec"]]);export{Le as default};
