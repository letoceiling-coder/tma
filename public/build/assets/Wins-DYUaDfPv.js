import{_ as k,c as i,a as e,b as _,d as c,v as m,A as z,z as C,F,q as S,t as n,r as g,k as D,o as p,p as P}from"./admin-DCecbpOE.js";import{a as U}from"./api-DccBIR6h.js";const V={name:"Wins",setup(){const u=g(!1),o=g([]),d=g({current_page:1,last_page:1,per_page:50,total:0}),t=g({date_from:"",date_to:"",user_search:"",prize_type:"all"}),l=async(s=1)=>{u.value=!0;try{const a=new URLSearchParams({page:s.toString(),per_page:d.value.per_page.toString()});t.value.date_from&&a.append("date_from",t.value.date_from),t.value.date_to&&a.append("date_to",t.value.date_to),t.value.user_search&&a.append("user_search",t.value.user_search),t.value.prize_type!=="all"&&a.append("prize_type",t.value.prize_type);const f=await U(`/wow/wins?${a.toString()}`);if(f.ok){const x=await f.json();o.value=x.data||[],d.value=x.pagination||d.value}}catch(a){console.error("Error loading wins:",a)}finally{u.value=!1}},b=()=>{l(1)},r=()=>{t.value={date_from:"",date_to:"",user_search:"",prize_type:"all"},l(1)},y=s=>{l(s)},v=s=>s?new Date(s).toLocaleString("ru-RU"):"-",w=s=>({money:"Деньги",ticket:"Билет",secret_box:"Секретный бокс",empty:"Пусто"})[s]||s,h=s=>({money:"px-2 py-1 rounded bg-green-500/10 text-green-600 text-xs font-medium",ticket:"px-2 py-1 rounded bg-blue-500/10 text-blue-600 text-xs font-medium",secret_box:"px-2 py-1 rounded bg-purple-500/10 text-purple-600 text-xs font-medium",empty:"px-2 py-1 rounded bg-gray-500/10 text-gray-600 text-xs font-medium"})[s]||"";return D(()=>{l()}),{loading:u,wins:o,pagination:d,filters:t,fetchWins:l,applyFilters:b,resetFilters:r,loadPage:y,formatDate:v,getPrizeTypeLabel:w,getPrizeTypeClass:h}}},T={class:"wins-page space-y-6"},j={class:"bg-card rounded-lg border border-border p-6 space-y-4"},L={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},M={class:"flex gap-2"},B={class:"bg-card rounded-lg border border-border overflow-hidden"},N={class:"overflow-x-auto"},W={class:"w-full"},E={class:"divide-y divide-border"},I={class:"px-6 py-4 whitespace-nowrap text-sm"},R={class:"px-6 py-4 whitespace-nowrap text-sm"},q={class:"px-6 py-4 whitespace-nowrap text-sm"},A={class:"px-6 py-4 whitespace-nowrap text-sm"},G={class:"px-6 py-4 whitespace-nowrap text-sm"},H={key:0,class:"px-6 py-4 border-t border-border flex items-center justify-between"},J={class:"text-sm text-muted-foreground"},K={class:"flex gap-2"},O=["disabled"],Q=["disabled"],X={key:0,class:"flex items-center justify-center py-12"};function Y(u,o,d,t,l,b){return p(),i("div",T,[o[16]||(o[16]=e("div",null,[e("h1",{class:"text-3xl font-semibold text-foreground"},"Победители"),e("p",{class:"text-muted-foreground mt-1"},"История всех выигрышей пользователей")],-1)),e("div",j,[o[13]||(o[13]=e("h2",{class:"text-lg font-semibold mb-4"},"Фильтры",-1)),e("div",L,[e("div",null,[o[8]||(o[8]=e("label",{class:"text-sm font-medium mb-1 block"},"Дата от",-1)),c(e("input",{"onUpdate:modelValue":o[0]||(o[0]=r=>t.filters.date_from=r),type:"date",class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[m,t.filters.date_from]])]),e("div",null,[o[9]||(o[9]=e("label",{class:"text-sm font-medium mb-1 block"},"Дата до",-1)),c(e("input",{"onUpdate:modelValue":o[1]||(o[1]=r=>t.filters.date_to=r),type:"date",class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[m,t.filters.date_to]])]),e("div",null,[o[10]||(o[10]=e("label",{class:"text-sm font-medium mb-1 block"},"Пользователь",-1)),c(e("input",{"onUpdate:modelValue":o[2]||(o[2]=r=>t.filters.user_search=r),type:"text",placeholder:"Telegram ID или username",class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[m,t.filters.user_search]])]),e("div",null,[o[12]||(o[12]=e("label",{class:"text-sm font-medium mb-1 block"},"Тип приза",-1)),c(e("select",{"onUpdate:modelValue":o[3]||(o[3]=r=>t.filters.prize_type=r),class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},[...o[11]||(o[11]=[C('<option value="all">Все</option><option value="money">Деньги</option><option value="ticket">Билет</option><option value="secret_box">Секретный бокс</option><option value="empty">Пусто</option>',5)])],512),[[z,t.filters.prize_type]])])]),e("div",M,[e("button",{onClick:o[4]||(o[4]=(...r)=>t.applyFilters&&t.applyFilters(...r)),class:"h-10 px-6 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-2xl shadow-lg shadow-accent/10 inline-flex items-center justify-center gap-2"}," Применить "),e("button",{onClick:o[5]||(o[5]=(...r)=>t.resetFilters&&t.resetFilters(...r)),class:"h-10 px-6 bg-muted text-muted-foreground border border-border hover:bg-muted/80 rounded-2xl inline-flex items-center justify-center gap-2"}," Сбросить ")])]),e("div",B,[e("div",N,[e("table",W,[o[14]||(o[14]=e("thead",{class:"bg-muted/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Telegram ID"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Username"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Название приза"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Номер сектора"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Дата и время выигрыша")])],-1)),e("tbody",E,[(p(!0),i(F,null,S(t.wins,r=>(p(),i("tr",{key:r.id,class:"hover:bg-muted/30"},[e("td",I,n(r.telegram_id||"-"),1),e("td",R,n(r.username||"-"),1),e("td",q,[e("span",{class:P(t.getPrizeTypeClass(r.prize_type))},n(r.prize_name||"-"),3)]),e("td",A,n(r.sector_number?"#"+r.sector_number:"-"),1),e("td",G,n(t.formatDate(r.spin_time)),1)]))),128))])])]),t.pagination.last_page>1?(p(),i("div",H,[e("div",J," Показано "+n((t.pagination.current_page-1)*t.pagination.per_page+1)+" - "+n(Math.min(t.pagination.current_page*t.pagination.per_page,t.pagination.total))+" из "+n(t.pagination.total),1),e("div",K,[e("button",{onClick:o[6]||(o[6]=r=>t.loadPage(t.pagination.current_page-1)),disabled:t.pagination.current_page===1,class:"h-10 px-4 border border-border rounded-lg hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed"}," Назад ",8,O),e("button",{onClick:o[7]||(o[7]=r=>t.loadPage(t.pagination.current_page+1)),disabled:t.pagination.current_page===t.pagination.last_page,class:"h-10 px-4 border border-border rounded-lg hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed"}," Вперед ",8,Q)])])):_("",!0)]),t.loading?(p(),i("div",X,[...o[15]||(o[15]=[e("p",{class:"text-muted-foreground"},"Загрузка выигрышей...",-1)])])):_("",!0)])}const ee=k(V,[["render",Y]]);export{ee as default};
