import{_ as y,r as b,m as i,k as L,z as S,c as l,b as g,a as e,p as u,t as d,j as D,o as c,f as I,h as E}from"./admin-BJZEhXMZ.js";const j={name:"SubscriptionInfo",setup(){const n=b(null),o=b(!0),a=b(null),t=i(()=>n.value&&n.value.is_active===!0),f=i(()=>n.value&&!n.value.is_active),p=i(()=>!n.value||!n.value.expires_at?!1:r.value<=3&&r.value>=0),r=i(()=>{if(!n.value||!n.value.expires_at)return null;try{const k=new Date(n.value.expires_at)-new Date,v=Math.ceil(k/(1e3*60*60*24));return v>=0?v:0}catch{return null}}),_=i(()=>{const s=r.value;return s===null?"":s===1?"день":s>=2&&s<=4?"дня":"дней"}),m=async()=>{try{const s=await D.get("/api/subscription/check");if(s.data.success&&(n.value=s.data.subscription,!s.data.is_active)){window.location.href="/subscription-expired";return}}catch(s){if(console.error("Ошибка проверки подписки:",s),s.response&&(s.response.status===403||s.response.status===404)){window.location.href="/subscription-expired";return}}finally{o.value=!1}},h=s=>{if(!s)return"-";try{return new Date(s).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return s}},w=s=>({active:"Активна",expired:"Истекла",suspended:"Приостановлена"})[s]||s;return L(()=>{m(),a.value=setInterval(()=>{m()},300*1e3)}),S(()=>{a.value&&clearInterval(a.value)}),{subscription:n,loading:o,isActive:t,isExpired:f,isExpiringSoon:p,daysLeft:r,daysText:_,formatDate:h,getStatusLabel:w}}},B={class:"subscription-card"},C={class:"subscription-header"},z={class:"subscription-details mt-3 space-y-2"},M={class:"detail-item flex justify-between items-center"},N={class:"value text-sm font-semibold"},V={class:"detail-item flex justify-between items-center"},T={class:"flex items-center gap-2"},U={class:"text-xs font-medium"},A={key:0},R={key:1};function q(n,o,a,t,f,p){return t.subscription?(c(),l("div",{key:0,class:u(["subscription-info",{"expiring-soon":t.isExpiringSoon,expired:t.isExpired}])},[e("div",B,[e("div",C,[o[0]||(o[0]=e("h3",{class:"text-sm font-semibold"},"Статус подписки",-1)),e("span",{class:u([["badge",`badge-${t.subscription.status}`],"px-3 py-1 rounded-full text-xs font-bold"])},d(t.getStatusLabel(t.subscription.status)),3)]),e("div",z,[e("div",M,[o[1]||(o[1]=e("span",{class:"label text-sm text-muted-foreground"},"Действует до:",-1)),e("span",N,d(t.formatDate(t.subscription.expires_at)),1)]),e("div",V,[o[2]||(o[2]=e("span",{class:"label text-sm text-muted-foreground"},"Осталось дней:",-1)),e("span",{class:u(["value text-sm font-semibold",{"text-warning":t.daysLeft<=3&&t.daysLeft>0,"text-destructive":t.daysLeft===0}])},d(t.daysLeft!==null?t.daysLeft:"-"),3)])]),t.isExpiringSoon?(c(),l("div",{key:0,class:u(["warning-notification mt-3 p-3 rounded-md border-l-4",{"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-500 text-yellow-800 dark:text-yellow-200":t.daysLeft>0,"bg-red-50 dark:bg-red-900/20 border-red-500 text-red-800 dark:text-red-200":t.daysLeft===0}])},[e("div",T,[o[4]||(o[4]=e("svg",{class:"h-4 w-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),e("span",U,[o[3]||(o[3]=e("strong",null,"Внимание!",-1)),t.daysLeft>0?(c(),l("span",A," Подписка истекает через "+d(t.daysLeft)+" "+d(t.daysText),1)):(c(),l("span",R," Подписка истекла! "))])])],2)):g("",!0)])],2)):g("",!0)}const F=y(j,[["render",q],["__scopeId","data-v-453d0fc7"]]),G={name:"Dashboard",components:{SubscriptionInfo:F}},H={class:"dashboard-page"};function J(n,o,a,t,f,p){const r=E("SubscriptionInfo");return c(),l("div",H,[o[0]||(o[0]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-foreground"},"Панель управления"),e("p",{class:"text-muted-foreground mt-1"},"Добро пожаловать в админ панель")],-1)),I(r),o[1]||(o[1]=e("div",{class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},[e("div",{class:"bg-card rounded-lg border border-border p-6"},[e("h2",{class:"text-lg font-semibold mb-2"},"Статистика"),e("p",{class:"text-muted-foreground"},"Здесь будет статистика")])],-1))])}const O=y(G,[["render",J]]);export{O as default};
