import{_ as v,c as l,a as e,w as x,d as p,b as h,e as d,v as k,p as w,t as b,D as m,r as c,k as y,j as g,o as u}from"./admin-jGwMljs8.js";const S={name:"StarsSettings",setup(){const o=c({stars_per_ticket_purchase:50,show_gift_button:!1,send_ticket_notification:!0}),t=c(null),n=c({}),s=c(!1),f=async()=>{try{const r=await g.get("/api/v1/wow/wheel/settings");if(r.data?.settings){const i=r.data.settings;o.value.stars_per_ticket_purchase=i.stars_per_ticket_purchase??50,o.value.show_gift_button=i.show_gift_button??!1,o.value.send_ticket_notification=i.send_ticket_notification??!0,t.value=i.stars_per_ticket_purchase??50}}catch(r){console.error("Failed to load settings:",r)}},_=async()=>{if(n.value={},s.value=!0,!o.value.stars_per_ticket_purchase||o.value.stars_per_ticket_purchase<1){n.value.stars_per_ticket_purchase="Значение должно быть не менее 1",s.value=!1;return}if(o.value.stars_per_ticket_purchase>5e3){n.value.stars_per_ticket_purchase="Значение не должно превышать 5000",s.value=!1;return}try{const r=await g.put("/api/v1/wow/wheel/settings",{stars_per_ticket_purchase:o.value.stars_per_ticket_purchase,show_gift_button:o.value.show_gift_button,send_ticket_notification:o.value.send_ticket_notification});if(r.data?.success)t.value=o.value.stars_per_ticket_purchase,alert("Настройки успешно сохранены");else throw new Error(r.data?.message||"Ошибка при сохранении")}catch(r){console.error("Failed to save settings:",r),r.response?.data?.errors?n.value=r.response.data.errors:alert("Ошибка при сохранении настроек: "+(r.response?.data?.message||r.message))}finally{s.value=!1}},a=async()=>{await f()};return y(()=>{f()}),{formData:o,currentValue:t,errors:n,isSaving:s,saveSettings:_,resetForm:a}}},D={class:"stars-settings-page"},V={class:"bg-card rounded-lg border border-border p-6"},T={class:"space-y-4"},F={key:0,class:"mt-1 text-sm text-destructive"},B={class:"pt-4 border-t border-border"},C={class:"flex items-center justify-between"},M={class:"ml-4"},j={class:"relative inline-flex items-center cursor-pointer"},N={class:"pt-4 border-t border-border"},U={class:"flex items-center justify-between"},E={class:"ml-4"},z={class:"relative inline-flex items-center cursor-pointer"},A={class:"bg-muted/50 rounded-lg p-4"},I={class:"text-sm text-muted-foreground"},P={class:"font-semibold text-foreground"},q={class:"flex items-center gap-4 pt-4 border-t border-border"},G=["disabled"],H={key:0},J={key:1},K=["disabled"];function L(o,t,n,s,f,_){return u(),l("div",D,[t[14]||(t[14]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-foreground"},"Telegram Stars"),e("p",{class:"text-muted-foreground mt-1"},"Настройки оплаты через Telegram Stars")],-1)),e("div",V,[e("form",{onSubmit:t[4]||(t[4]=x((...a)=>s.saveSettings&&s.saveSettings(...a),["prevent"])),class:"space-y-6"},[e("div",T,[e("div",null,[t[5]||(t[5]=e("label",{for:"stars_per_ticket_purchase",class:"block text-sm font-medium text-foreground mb-2"},[d(" Стоимость прокрута в звёздах "),e("span",{class:"text-destructive"},"*")],-1)),p(e("input",{id:"stars_per_ticket_purchase","onUpdate:modelValue":t[0]||(t[0]=a=>s.formData.stars_per_ticket_purchase=a),type:"number",min:"1",max:"5000",placeholder:"50",class:w(["w-full px-4 py-2 bg-input border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent",{"border-destructive":s.errors.stars_per_ticket_purchase}])},null,2),[[k,s.formData.stars_per_ticket_purchase,void 0,{number:!0}]]),s.errors.stars_per_ticket_purchase?(u(),l("p",F,b(s.errors.stars_per_ticket_purchase),1)):h("",!0),t[6]||(t[6]=e("p",{class:"mt-2 text-sm text-muted-foreground"},[d(" Укажите, сколько Telegram Stars нужно списывать за покупку прокрутов. Если не указано — будет использоваться дефолтное значение 50. "),e("br"),e("span",{class:"text-xs"},"Это значение используется при создании инвойса через Telegram Bot API.")],-1))]),e("div",B,[e("div",C,[t[8]||(t[8]=e("div",{class:"flex-1"},[e("label",{for:"show_gift_button",class:"block text-sm font-medium text-foreground mb-2"},' Показывать кнопку "Подарок" на главной странице '),e("p",{class:"text-sm text-muted-foreground"},' Включите, чтобы отображать кнопку "Подарок" справа от кнопки "Как играть?" на главной странице мини-приложения. ')],-1)),e("div",M,[e("label",j,[p(e("input",{id:"show_gift_button","onUpdate:modelValue":t[1]||(t[1]=a=>s.formData.show_gift_button=a),type:"checkbox",class:"sr-only peer"},null,512),[[m,s.formData.show_gift_button]]),t[7]||(t[7]=e("div",{class:"w-11 h-6 bg-muted peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-ring/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-border after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"},null,-1))])])])]),e("div",N,[e("div",U,[t[10]||(t[10]=e("div",{class:"flex-1"},[e("label",{for:"send_ticket_notification",class:"block text-sm font-medium text-foreground mb-2"}," Отправлять уведомления о начислении билетов "),e("p",{class:"text-sm text-muted-foreground"}," Включите, чтобы отправлять пользователям уведомления в Telegram при начислении новых билетов (например, через 24 часа по таймеру). ")],-1)),e("div",E,[e("label",z,[p(e("input",{id:"send_ticket_notification","onUpdate:modelValue":t[2]||(t[2]=a=>s.formData.send_ticket_notification=a),type:"checkbox",class:"sr-only peer"},null,512),[[m,s.formData.send_ticket_notification]]),t[9]||(t[9]=e("div",{class:"w-11 h-6 bg-muted peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-ring/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-border after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"},null,-1))])])])]),e("div",A,[t[13]||(t[13]=e("h3",{class:"text-sm font-semibold text-foreground mb-2"},"Текущее значение",-1)),e("p",I,[t[11]||(t[11]=d(" Сейчас за покупку 20 прокрутов списывается ",-1)),e("span",P,b(s.currentValue||50),1),t[12]||(t[12]=d(" звёзд ",-1))])])]),e("div",q,[e("button",{type:"submit",disabled:s.isSaving,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[s.isSaving?(u(),l("span",J,"Сохранение...")):(u(),l("span",H,"Сохранить"))],8,G),e("button",{type:"button",onClick:t[3]||(t[3]=(...a)=>s.resetForm&&s.resetForm(...a)),disabled:s.isSaving,class:"px-6 py-2 bg-muted text-muted-foreground rounded-lg hover:bg-muted/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," Отменить ",8,K)])],32)])])}const Q=v(S,[["render",L]]);export{Q as default};
