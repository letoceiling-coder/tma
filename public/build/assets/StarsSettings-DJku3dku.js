import{_ as b,c as i,a as s,w as v,d as f,b as x,e as d,v as k,p as h,t as m,r as l,k as y,j as g,o as c}from"./admin-CbdoWQqS.js";const w={name:"StarsSettings",setup(){const a=l({stars_per_ticket_purchase:50}),e=l(null),n=l({}),t=l(!1),u=async()=>{try{const r=await g.get("/api/v1/wow/wheel/settings");if(r.data?.settings){const _=r.data.settings;a.value.stars_per_ticket_purchase=_.stars_per_ticket_purchase??50,e.value=_.stars_per_ticket_purchase??50}}catch(r){console.error("Failed to load settings:",r)}},p=async()=>{if(n.value={},t.value=!0,!a.value.stars_per_ticket_purchase||a.value.stars_per_ticket_purchase<1){n.value.stars_per_ticket_purchase="Значение должно быть не менее 1",t.value=!1;return}if(a.value.stars_per_ticket_purchase>5e3){n.value.stars_per_ticket_purchase="Значение не должно превышать 5000",t.value=!1;return}try{const r=await g.put("/api/v1/wow/wheel/settings",{stars_per_ticket_purchase:a.value.stars_per_ticket_purchase});if(r.data?.success)e.value=a.value.stars_per_ticket_purchase,alert("Настройки успешно сохранены");else throw new Error(r.data?.message||"Ошибка при сохранении")}catch(r){console.error("Failed to save settings:",r),r.response?.data?.errors?n.value=r.response.data.errors:alert("Ошибка при сохранении настроек: "+(r.response?.data?.message||r.message))}finally{t.value=!1}},o=async()=>{await u()};return y(()=>{u()}),{formData:a,currentValue:e,errors:n,isSaving:t,saveSettings:p,resetForm:o}}},S={class:"stars-settings-page"},T={class:"bg-card rounded-lg border border-border p-6"},V={class:"space-y-4"},D={key:0,class:"mt-1 text-sm text-destructive"},F={class:"bg-muted/50 rounded-lg p-4"},B={class:"text-sm text-muted-foreground"},C={class:"font-semibold text-foreground"},M={class:"flex items-center gap-4 pt-4 border-t border-border"},N=["disabled"],E={key:0},j={key:1},z=["disabled"];function A(a,e,n,t,u,p){return c(),i("div",S,[e[8]||(e[8]=s("div",{class:"mb-6"},[s("h1",{class:"text-2xl font-bold text-foreground"},"Telegram Stars"),s("p",{class:"text-muted-foreground mt-1"},"Настройки оплаты через Telegram Stars")],-1)),s("div",T,[s("form",{onSubmit:e[2]||(e[2]=v((...o)=>t.saveSettings&&t.saveSettings(...o),["prevent"])),class:"space-y-6"},[s("div",V,[s("div",null,[e[3]||(e[3]=s("label",{for:"stars_per_ticket_purchase",class:"block text-sm font-medium text-foreground mb-2"},[d(" Стоимость прокрута в звёздах "),s("span",{class:"text-destructive"},"*")],-1)),f(s("input",{id:"stars_per_ticket_purchase","onUpdate:modelValue":e[0]||(e[0]=o=>t.formData.stars_per_ticket_purchase=o),type:"number",min:"1",max:"5000",placeholder:"50",class:h(["w-full px-4 py-2 bg-input border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent",{"border-destructive":t.errors.stars_per_ticket_purchase}])},null,2),[[k,t.formData.stars_per_ticket_purchase,void 0,{number:!0}]]),t.errors.stars_per_ticket_purchase?(c(),i("p",D,m(t.errors.stars_per_ticket_purchase),1)):x("",!0),e[4]||(e[4]=s("p",{class:"mt-2 text-sm text-muted-foreground"},[d(" Укажите, сколько Telegram Stars нужно списывать за покупку прокрутов. Если не указано — будет использоваться дефолтное значение 50. "),s("br"),s("span",{class:"text-xs"},"Это значение используется при создании инвойса через Telegram Bot API.")],-1))]),s("div",F,[e[7]||(e[7]=s("h3",{class:"text-sm font-semibold text-foreground mb-2"},"Текущее значение",-1)),s("p",B,[e[5]||(e[5]=d(" Сейчас за покупку 20 прокрутов списывается ",-1)),s("span",C,m(t.currentValue||50),1),e[6]||(e[6]=d(" звёзд ",-1))])])]),s("div",M,[s("button",{type:"submit",disabled:t.isSaving,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[t.isSaving?(c(),i("span",j,"Сохранение...")):(c(),i("span",E,"Сохранить"))],8,N),s("button",{type:"button",onClick:e[1]||(e[1]=(...o)=>t.resetForm&&t.resetForm(...o)),disabled:t.isSaving,class:"px-6 py-2 bg-muted text-muted-foreground rounded-lg hover:bg-muted/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," Отменить ",8,z)])],32)])])}const P=b(w,[["render",A]]);export{P as default};
