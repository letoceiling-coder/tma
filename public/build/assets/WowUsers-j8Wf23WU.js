import{_ as C,c as n,a as e,b as u,d as p,v as y,G as j,t as r,F as T,q as D,r as a,k as P,o as l}from"./admin-BCbIefQp.js";import{c as h}from"./api-BACpyIk9.js";const V={name:"WowUsers",setup(){const m=a(!1),t=a(null),b=a([]),o=a(null),v=a(15),_=a({current_page:1,last_page:1,total:0,from:0,to:0}),s=a({search:"",date_from:"",date_to:""});let g=null;const x=async(c=1)=>{m.value=!0,t.value=null;try{const d={page:c,per_page:v.value};s.value.search&&(d.search=s.value.search),s.value.date_from&&(d.date_from=s.value.date_from),s.value.date_to&&(d.date_to=s.value.date_to);const f=await h("/wow/users",d);if(!f.ok)throw new Error("Ошибка загрузки пользователей");const i=await f.json();b.value=i.data||[],_.value={current_page:i.current_page||1,last_page:i.last_page||1,total:i.total||0,from:i.from||0,to:i.to||0}}catch(d){t.value=d.message||"Ошибка загрузки пользователей"}finally{m.value=!1}},w=()=>{g&&clearTimeout(g),g=setTimeout(()=>{x(1)},500)},k=c=>{x(c)},U=async c=>{try{const d=await h(`/wow/users/${c.id}`);if(!d.ok)throw new Error("Ошибка загрузки данных пользователя");const f=await d.json();o.value=f.data}catch(d){console.error("Error loading user details:",d)}};return P(()=>{x()}),{loading:m,error:t,users:b,selectedUser:o,pagination:_,perPage:v,filters:s,fetchUsers:x,handleSearch:w,changePage:k,viewUser:U}}},I={class:"wow-users-page space-y-6"},S={class:"bg-card rounded-lg border border-border p-4 space-y-4"},E={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},W={key:0,class:"flex items-center justify-center py-12"},B={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},M={class:"text-destructive"},F={key:2,class:"bg-card rounded-lg border border-border overflow-hidden"},G={class:"overflow-x-auto"},N={class:"w-full"},q={class:"divide-y divide-border"},z={class:"px-6 py-4 text-sm text-foreground"},L={class:"px-6 py-4 text-sm text-foreground"},O={class:"px-6 py-4 text-sm font-medium text-foreground"},A={class:"px-6 py-4 text-sm text-foreground"},H={class:"px-2 py-1 bg-blue-500/10 text-blue-600 rounded"},J={class:"px-6 py-4 text-sm text-foreground"},K={class:"px-6 py-4 text-sm text-foreground"},Q={class:"px-6 py-4 text-sm text-foreground"},R={class:"px-6 py-4 text-sm text-right"},X=["onClick"],Y={key:0,class:"px-6 py-4 border-t border-border flex items-center justify-between"},Z={class:"text-sm text-muted-foreground"},$={class:"flex gap-2"},ee=["disabled"],te=["disabled"],oe={key:3,class:"bg-card rounded-lg border border-border p-12 text-center"},se={key:4,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4"},re={class:"bg-background border border-border rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto"},de={class:"p-6 border-b border-border"},ne={class:"flex items-center justify-between"},le={class:"text-lg font-semibold"},ae={class:"p-6 space-y-6"},ie={class:"grid grid-cols-2 gap-4"},ue={class:"text-sm font-medium"},ce={class:"text-sm font-medium"},me={class:"text-sm font-medium"},ge={class:"text-sm font-medium"},xe={class:"text-sm font-medium"},fe={class:"text-sm font-medium"};function pe(m,t,b,o,v,_){return l(),n("div",I,[t[25]||(t[25]=e("div",{class:"flex items-center justify-between"},[e("div",null,[e("h1",{class:"text-3xl font-semibold text-foreground"},"Пользователи WOW"),e("p",{class:"text-muted-foreground mt-1"},"Управление пользователями рулетки")])],-1)),e("div",S,[e("div",E,[e("div",null,[t[11]||(t[11]=e("label",{class:"text-sm font-medium mb-1 block"},"Поиск",-1)),p(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.filters.search=s),type:"text",placeholder:"Username, Telegram ID...",onInput:t[1]||(t[1]=(...s)=>o.handleSearch&&o.handleSearch(...s)),class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,544),[[y,o.filters.search]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"text-sm font-medium mb-1 block"},"Дата от",-1)),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.filters.date_from=s),type:"date",onChange:t[3]||(t[3]=(...s)=>o.fetchUsers&&o.fetchUsers(...s)),class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,544),[[y,o.filters.date_from]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"text-sm font-medium mb-1 block"},"Дата до",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>o.filters.date_to=s),type:"date",onChange:t[5]||(t[5]=(...s)=>o.fetchUsers&&o.fetchUsers(...s)),class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},null,544),[[y,o.filters.date_to]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"text-sm font-medium mb-1 block"},"На странице",-1)),p(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>o.perPage=s),onChange:t[7]||(t[7]=(...s)=>o.fetchUsers&&o.fetchUsers(...s)),class:"w-full h-10 px-4 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-accent"},[...t[14]||(t[14]=[e("option",{value:15},"15",-1),e("option",{value:25},"25",-1),e("option",{value:50},"50",-1),e("option",{value:100},"100",-1)])],544),[[j,o.perPage]])])])]),o.loading?(l(),n("div",W,[...t[16]||(t[16]=[e("p",{class:"text-muted-foreground"},"Загрузка пользователей...",-1)])])):u("",!0),o.error?(l(),n("div",B,[e("p",M,r(o.error),1)])):u("",!0),!o.loading&&o.users.length>0?(l(),n("div",F,[e("div",G,[e("table",N,[t[17]||(t[17]=e("thead",{class:"bg-muted/30 border-b border-border"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase"},"ID"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase"},"Telegram ID"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase"},"Username"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase"},"Билеты"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase"},"Прокруты"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase"},"Выигрыши"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase"},"Приглашения"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-muted-foreground uppercase"},"Действия")])],-1)),e("tbody",q,[(l(!0),n(T,null,D(o.users,s=>(l(),n("tr",{key:s.id,class:"hover:bg-muted/10"},[e("td",z,r(s.id),1),e("td",L,r(s.telegram_id),1),e("td",O,r(s.username||"—"),1),e("td",A,[e("span",H,r(s.tickets_available||0)+"/3 ",1)]),e("td",J,r(s.spins_count||0),1),e("td",K,r(s.total_wins||0),1),e("td",Q,r(s.invites_count||0),1),e("td",R,[e("button",{onClick:g=>o.viewUser(s),class:"px-3 py-1 text-xs bg-blue-500 hover:bg-blue-600 text-white rounded transition-colors"}," Подробнее ",8,X)])]))),128))])])]),o.pagination.last_page>1?(l(),n("div",Y,[e("div",Z," Показано "+r(o.pagination.from)+" - "+r(o.pagination.to)+" из "+r(o.pagination.total),1),e("div",$,[e("button",{onClick:t[8]||(t[8]=s=>o.changePage(o.pagination.current_page-1)),disabled:o.pagination.current_page===1,class:"px-4 py-2 text-sm border border-border rounded-lg hover:bg-muted/10 disabled:opacity-50 disabled:cursor-not-allowed"}," Назад ",8,ee),e("button",{onClick:t[9]||(t[9]=s=>o.changePage(o.pagination.current_page+1)),disabled:o.pagination.current_page===o.pagination.last_page,class:"px-4 py-2 text-sm border border-border rounded-lg hover:bg-muted/10 disabled:opacity-50 disabled:cursor-not-allowed"}," Вперед ",8,te)])])):u("",!0)])):u("",!0),!o.loading&&o.users.length===0?(l(),n("div",oe,[...t[18]||(t[18]=[e("p",{class:"text-muted-foreground"},"Пользователи не найдены",-1)])])):u("",!0),o.selectedUser?(l(),n("div",se,[e("div",re,[e("div",de,[e("div",ne,[e("h3",le,"Пользователь #"+r(o.selectedUser.id),1),e("button",{onClick:t[10]||(t[10]=s=>o.selectedUser=null),class:"text-muted-foreground hover:text-foreground"}," ✕ ")])]),e("div",ae,[e("div",ie,[e("div",null,[t[19]||(t[19]=e("p",{class:"text-sm text-muted-foreground"},"Telegram ID",-1)),e("p",ue,r(o.selectedUser.telegram_id),1)]),e("div",null,[t[20]||(t[20]=e("p",{class:"text-sm text-muted-foreground"},"Username",-1)),e("p",ce,r(o.selectedUser.username||"—"),1)]),e("div",null,[t[21]||(t[21]=e("p",{class:"text-sm text-muted-foreground"},"Билеты",-1)),e("p",me,r(o.selectedUser.tickets_available||0)+"/3",1)]),e("div",null,[t[22]||(t[22]=e("p",{class:"text-sm text-muted-foreground"},"Звёзды",-1)),e("p",ge,r(o.selectedUser.stars_balance||0),1)]),e("div",null,[t[23]||(t[23]=e("p",{class:"text-sm text-muted-foreground"},"Всего прокрутов",-1)),e("p",xe,r(o.selectedUser.spins_count||0),1)]),e("div",null,[t[24]||(t[24]=e("p",{class:"text-sm text-muted-foreground"},"Выигрышей",-1)),e("p",fe,r(o.selectedUser.total_wins||0),1)])])])])])):u("",!0)])}const _e=C(V,[["render",pe]]);export{_e as default};
